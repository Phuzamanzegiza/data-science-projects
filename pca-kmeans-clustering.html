<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Francis" />

<meta name="date" content="2024-06-07" />

<title>Customer Segmenation for a Digital TV Company</title>

<script src="site_libs/header-attrs-2.26/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/htmltools-fill-0.5.8/fill.css" rel="stylesheet" />
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<!-- header.html -->
<style>
body {
  font-family: 'Montserrat', sans-serif;
}

h1, h2, h3, h4, h5, h6 {
  color: #333;
}

p {
  color: #555;
}

.container-fluid {
  margin-top: 10px; /* Adjust based on the navbar height */
}
</style>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Projects</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="diabetes-clusters.html">Diabetes Risk Factors</a>
</li>
<li>
  <a href="hierarchical-clustering.html">Hierarchical Clustering</a>
</li>
<li>
  <a href="random-forest.html">Consumer Behaviour</a>
</li>
<li>
  <a href="pca-kmeans-clustering.html">Customer Segmentation</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="styles.css">
  <style>
    body {
      font-family: 'Montserrat', sans-serif;
    }

    .navbar {
      background-color: #2c3e50;
      border: none;
    }

    .navbar-header .navbar-brand {
      font-weight: bold;
      font-size: 24px;
      color: #ecf0f1 !important;
    }

    .navbar-nav > li > a {
      color: #ecf0f1 !important;
      padding: 15px 20px;
      transition: background-color 0.3s ease;
    }

    .navbar-nav > li > a:hover, 
    .navbar-nav > li > a:focus {
      background-color: #34495e;
      color: #ecf0f1 !important;
    }

    .navbar-toggle {
      border-color: transparent;
    }

    .navbar-toggle .icon-bar {
      background-color: #ecf0f1;
    }

    main {
      padding-top: 70px; /* Adjust based on the navbar height */
    }
  </style>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
</head>
<body>

<nav class="navbar navbar-default navbar-fixed-top">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>                        
      </button>
      <a class="navbar-brand" href="index.html">Projects</a>
    </div>
    <div class="collapse navbar-collapse" id="myNavbar">
      <ul class="nav navbar-nav">
        <li><a href="index.html">Home</a></li>
        <li><a href="hierarchical-clustering.html">Hierarchical Clustering</a></li>
        <li><a href="random-forest.html">Consumer Behaviour</a></li>
        <li><a href="pca-kmeans-clustering.html">Customer Segmentation</a></li>
      </ul>
    </div>
  </div>
</nav>

<main>
  <!-- Main content goes here -->
</main>

</body>
</html>

<div id="header">



<h1 class="title toc-ignore">Customer Segmenation for a Digital TV
Company</h1>
<h4 class="author">Francis</h4>
<h4 class="date">2024-06-07</h4>

</div>


<style type="text/css">
  body {font-family: Montserrat, sans-serif;}
h1 {font-size: 33px;}
h1.title {font-size: 36px;}
h2 {font-size: 30px;}
h3 {font-size: 24px;}
h4 {font-size: 18px;}
h5 {font-size: 16px;}
h6 {font-size: 12px;}
 p {font-size: 16px;}
}
</style>
<div id="data-loading-and-preprocessing" class="section level1">
<h1>Data Loading and Preprocessing</h1>
<p>The dataset was loaded using the <code>read_excel</code> function
from the “Survey_Data_1.xlsx” file. To understand the structure and
contents of the dataset, the <code>str()</code> function was used to
display the structure, which provides information about the data types
and the number of observations in each column. A more detailed view was
obtained using the <code>glimpse()</code> function, which gives a quick
overview of the dataset.</p>
<p>Summary statistics were then generated using the
<code>summary()</code> function, providing key metrics such as mean,
median, and quartiles for numerical columns, as well as counts for
categorical columns. Lastly, to ensure data quality, the presence of
missing values in each column was checked using the
<code>colSums(is.na(data))</code> function. This step is crucial for
identifying potential data preprocessing needs before further
analysis.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># Load the dataset</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;Survey_Data_1.xlsx&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co"># Display the structure of the dataset</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">str</span>(data)</span></code></pre></div>
<pre><code>## tibble [1,000 × 22] (S3: tbl_df/tbl/data.frame)
##  $ ID                                   : num [1:1000] 1 2 3 4 5 6 7 8 9 10 ...
##  $ Gender                               : chr [1:1000] &quot;male&quot; &quot;male&quot; &quot;male&quot; &quot;male&quot; ...
##  $ Coded Gender                         : num [1:1000] 1 1 1 1 0 0 1 1 1 0 ...
##  $ Marital Status                       : chr [1:1000] &quot;married&quot; &quot;single&quot; &quot;married&quot; &quot;married&quot; ...
##  $ Work Status                          : chr [1:1000] &quot;professional&quot; &quot;none&quot; &quot;professional&quot; &quot;none&quot; ...
##  $ Education                            : chr [1:1000] &quot;none&quot; &quot;none&quot; &quot;BA&quot; &quot;PhD&quot; ...
##  $ Ed coded                             : num [1:1000] 0 0 1 3 0 1 0 0 0 0 ...
##  $ Annual Income (x1000 $)              : num [1:1000] 49 46 58 51 46 31 33 29 57 30 ...
##  $ Age                                  : num [1:1000] 30 36 66 78 52 72 62 30 60 59 ...
##  $ Location                             : chr [1:1000] &quot;Florida&quot; &quot;Alabama&quot; &quot;Massachusetts&quot; &quot;New York&quot; ...
##  $ Purchasing Decision Maker            : chr [1:1000] &quot;family&quot; &quot;single&quot; &quot;family&quot; &quot;family&quot; ...
##  $ Purchasing Location                  : chr [1:1000] &quot;mass-consumer electronics&quot; &quot;mass-consumer electronics&quot; &quot;specialty stores&quot; &quot;mass-consumer electronics&quot; ...
##  $ PL coded                             : num [1:1000] 1 1 2 1 1 3 4 3 2 4 ...
##  $ Monthly Electronics Spend            : num [1:1000] 35 35 64 33 45 14 18 23 74 16 ...
##  $ Annual spending on electronics       : num [1:1000] 420 420 768 396 540 168 216 276 888 192 ...
##  $ Spending as % of income              : num [1:1000] 0.00857 0.00913 0.01324 0.00776 0.01174 ...
##  $ Monthly Household Spend              : num [1:1000] 150 163 103 154 161 21 40 75 358 78 ...
##  $ Purchasing Frequency (every x months): num [1:1000] 13 26 13 22 47 32 41 9 1 25 ...
##  $ Technology Adoption                  : chr [1:1000] &quot;late&quot; &quot;late&quot; &quot;early&quot; &quot;late&quot; ...
##  $ TV Viewing (hours/day)               : num [1:1000] 2 10 0 5 2 1 0 1 0 0 ...
##  $ Favorite feature                     : chr [1:1000] &quot;saving favorite shows to watch as a family&quot; &quot;saving favorite shows to watch as a family&quot; &quot;time shifting&quot; &quot;saving favorite shows to watch as a family&quot; ...
##  $ FF coded                             : num [1:1000] 1 1 2 1 1 2 3 4 4 4 ...</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Glimpse of the dataset</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">glimpse</span>(data)</span></code></pre></div>
<pre><code>## Rows: 1,000
## Columns: 22
## $ ID                                      &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,…
## $ Gender                                  &lt;chr&gt; &quot;male&quot;, &quot;male&quot;, &quot;male&quot;, &quot;male&quot;, &quot;female&quot;, &quot;female&quot;, &quot;male&quot;, &quot;male&quot;, &quot;male&quot;, &quot;femal…
## $ `Coded Gender`                          &lt;dbl&gt; 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1…
## $ `Marital Status`                        &lt;chr&gt; &quot;married&quot;, &quot;single&quot;, &quot;married&quot;, &quot;married&quot;, &quot;single&quot;, &quot;married&quot;, &quot;married&quot;, &quot;marrie…
## $ `Work Status`                           &lt;chr&gt; &quot;professional&quot;, &quot;none&quot;, &quot;professional&quot;, &quot;none&quot;, &quot;none&quot;, &quot;none&quot;, &quot;professional&quot;, &quot;n…
## $ Education                               &lt;chr&gt; &quot;none&quot;, &quot;none&quot;, &quot;BA&quot;, &quot;PhD&quot;, &quot;none&quot;, &quot;BA&quot;, &quot;none&quot;, &quot;none&quot;, &quot;none&quot;, &quot;none&quot;, &quot;PhD&quot;, …
## $ `Ed coded`                              &lt;dbl&gt; 0, 0, 1, 3, 0, 1, 0, 0, 0, 0, 3, 0, 1, 0, 0, 0, 1, 0, 3, 0, 2, 0, 0, 0, 1, 0, 0, 0…
## $ `Annual Income (x1000 $)`               &lt;dbl&gt; 49, 46, 58, 51, 46, 31, 33, 29, 57, 30, 29, 49, 64, 27, 27, 33, 31, 28, 29, 28, 50…
## $ Age                                     &lt;dbl&gt; 30, 36, 66, 78, 52, 72, 62, 30, 60, 59, 25, 57, 80, 36, 61, 54, 58, 30, 25, 58, 75…
## $ Location                                &lt;chr&gt; &quot;Florida&quot;, &quot;Alabama&quot;, &quot;Massachusetts&quot;, &quot;New York&quot;, &quot;Montana&quot;, &quot;New Jersey&quot;, &quot;Calif…
## $ `Purchasing Decision Maker`             &lt;chr&gt; &quot;family&quot;, &quot;single&quot;, &quot;family&quot;, &quot;family&quot;, &quot;single&quot;, &quot;single&quot;, &quot;single&quot;, &quot;single&quot;, &quot;f…
## $ `Purchasing Location`                   &lt;chr&gt; &quot;mass-consumer electronics&quot;, &quot;mass-consumer electronics&quot;, &quot;specialty stores&quot;, &quot;mas…
## $ `PL coded`                              &lt;dbl&gt; 1, 1, 2, 1, 1, 3, 4, 3, 2, 4, 4, 1, 2, 4, 3, 3, 4, 4, 3, 3, 1, 4, 1, 1, 3, 4, 3, 4…
## $ `Monthly Electronics Spend`             &lt;dbl&gt; 35, 35, 64, 33, 45, 14, 18, 23, 74, 16, 38, 46, 53, 16, 14, 14, 16, 14, 24, 17, 47…
## $ `Annual spending on electronics`        &lt;dbl&gt; 420, 420, 768, 396, 540, 168, 216, 276, 888, 192, 456, 552, 636, 192, 168, 168, 19…
## $ `Spending as % of income`               &lt;dbl&gt; 0.008571429, 0.009130435, 0.013241379, 0.007764706, 0.011739130, 0.005419355, 0.00…
## $ `Monthly Household Spend`               &lt;dbl&gt; 150, 163, 103, 154, 161, 21, 40, 75, 358, 78, 66, 225, 257, 48, 60, 24, 44, 66, 10…
## $ `Purchasing Frequency (every x months)` &lt;dbl&gt; 13, 26, 13, 22, 47, 32, 41, 9, 1, 25, 2, 20, 10, 8, 39, 16, 14, 8, 11, 16, 17, 15,…
## $ `Technology Adoption`                   &lt;chr&gt; &quot;late&quot;, &quot;late&quot;, &quot;early&quot;, &quot;late&quot;, &quot;late&quot;, &quot;early&quot;, &quot;early&quot;, &quot;early&quot;, &quot;early&quot;, &quot;earl…
## $ `TV Viewing (hours/day)`                &lt;dbl&gt; 2, 10, 0, 5, 2, 1, 0, 1, 0, 0, 6, 5, 1, 2, 1, 0, 1, 2, 5, 0, 8, 1, 5, 8, 6, 2, 2, …
## $ `Favorite feature`                      &lt;chr&gt; &quot;saving favorite shows to watch as a family&quot;, &quot;saving favorite shows to watch as a…
## $ `FF coded`                              &lt;dbl&gt; 1, 1, 2, 1, 1, 2, 3, 4, 4, 4, 5, 1, 3, 4, 3, 3, 3, 3, 5, 2, 1, 3, 1, 1, 5, 4, 3, 4…</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Display summary statistics</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">summary</span>(data)</span></code></pre></div>
<pre><code>##        ID            Gender           Coded Gender   Marital Status     Work Status         Education            Ed coded    
##  Min.   :   1.0   Length:1000        Min.   :0.000   Length:1000        Length:1000        Length:1000        Min.   :0.000  
##  1st Qu.: 250.8   Class :character   1st Qu.:0.000   Class :character   Class :character   Class :character   1st Qu.:0.000  
##  Median : 500.5   Mode  :character   Median :1.000   Mode  :character   Mode  :character   Mode  :character   Median :0.000  
##  Mean   : 500.5                      Mean   :0.535                                                            Mean   :0.838  
##  3rd Qu.: 750.2                      3rd Qu.:1.000                                                            3rd Qu.:1.000  
##  Max.   :1000.0                      Max.   :1.000                                                            Max.   :3.000  
##  Annual Income (x1000 $)      Age          Location         Purchasing Decision Maker Purchasing Location    PL coded    
##  Min.   : 21.00          Min.   :18.00   Length:1000        Length:1000               Length:1000         Min.   :1.000  
##  1st Qu.: 29.00          1st Qu.:32.00   Class :character   Class :character          Class :character    1st Qu.:2.000  
##  Median : 33.00          Median :49.00   Mode  :character   Mode  :character          Mode  :character    Median :3.000  
##  Mean   : 39.01          Mean   :48.34                                                                    Mean   :2.809  
##  3rd Qu.: 48.25          3rd Qu.:63.00                                                                    3rd Qu.:4.000  
##  Max.   :730.00          Max.   :80.00                                                                    Max.   :5.000  
##  Monthly Electronics Spend Annual spending on electronics Spending as % of income Monthly Household Spend
##  Min.   : 7.00             Min.   :  84.0                 Min.   :0.001031        Min.   : 10.00         
##  1st Qu.:17.00             1st Qu.: 204.0                 1st Qu.:0.006743        1st Qu.: 47.00         
##  Median :25.50             Median : 306.0                 Median :0.008769        Median : 73.00         
##  Mean   :30.96             Mean   : 371.5                 Mean   :0.009418        Mean   : 94.24         
##  3rd Qu.:42.00             3rd Qu.: 504.0                 3rd Qu.:0.011767        3rd Qu.:124.00         
##  Max.   :88.00             Max.   :1056.0                 Max.   :0.019556        Max.   :390.00         
##  Purchasing Frequency (every x months) Technology Adoption TV Viewing (hours/day) Favorite feature      FF coded   
##  Min.   : 1.00                         Length:1000         Min.   : 0.00          Length:1000        Min.   :1.00  
##  1st Qu.:11.00                         Class :character    1st Qu.: 1.00          Class :character   1st Qu.:2.00  
##  Median :22.00                         Mode  :character    Median : 1.00          Mode  :character   Median :3.00  
##  Mean   :22.99                                             Mean   : 2.37                             Mean   :2.86  
##  3rd Qu.:35.00                                             3rd Qu.: 2.00                             3rd Qu.:4.00  
##  Max.   :48.00                                             Max.   :14.00                             Max.   :5.00</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Check for missing values in each column</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(data))</span></code></pre></div>
<pre><code>##                                    ID                                Gender                          Coded Gender 
##                                     0                                     0                                     0 
##                        Marital Status                           Work Status                             Education 
##                                     0                                     0                                     0 
##                              Ed coded               Annual Income (x1000 $)                                   Age 
##                                     0                                     0                                     0 
##                              Location             Purchasing Decision Maker                   Purchasing Location 
##                                     0                                     0                                     0 
##                              PL coded             Monthly Electronics Spend        Annual spending on electronics 
##                                     0                                     0                                     0 
##               Spending as % of income               Monthly Household Spend Purchasing Frequency (every x months) 
##                                     0                                     0                                     0 
##                   Technology Adoption                TV Viewing (hours/day)                      Favorite feature 
##                                     0                                     0                                     0 
##                              FF coded 
##                                     0</code></pre>
<div id="column-renaming-for-compatibilty" class="section level2">
<h2>Column Renaming for Compatibilty</h2>
<p>To prepare the dataset for analysis, the column names were
standardized by removing non-alphanumeric characters. This was achieved
using the <code>gsub</code> function, which eliminated any characters
that were not letters, numbers, or underscores. This step ensures that
the column names are consistent and easier to reference in subsequent
analyses, reducing the likelihood of errors. The modified column names
were then printed to verify the changes, confirming the successful
standardization of the dataset’s structure.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Modify column names</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">colnames</span>(data) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;[^A-Za-z0-9_]+&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">colnames</span>(data))  <span class="co"># Remove non-alphanumeric characters</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co"># Print modified column names</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">colnames</span>(data))</span></code></pre></div>
<pre><code>##  [1] &quot;ID&quot;                              &quot;Gender&quot;                          &quot;CodedGender&quot;                    
##  [4] &quot;MaritalStatus&quot;                   &quot;WorkStatus&quot;                      &quot;Education&quot;                      
##  [7] &quot;Edcoded&quot;                         &quot;AnnualIncomex1000&quot;               &quot;Age&quot;                            
## [10] &quot;Location&quot;                        &quot;PurchasingDecisionMaker&quot;         &quot;PurchasingLocation&quot;             
## [13] &quot;PLcoded&quot;                         &quot;MonthlyElectronicsSpend&quot;         &quot;Annualspendingonelectronics&quot;    
## [16] &quot;Spendingasofincome&quot;              &quot;MonthlyHouseholdSpend&quot;           &quot;PurchasingFrequencyeveryxmonths&quot;
## [19] &quot;TechnologyAdoption&quot;              &quot;TVViewinghoursday&quot;               &quot;Favoritefeature&quot;                
## [22] &quot;FFcoded&quot;</code></pre>
</div>
<div id="distribution-for-numerical-variables" class="section level2">
<h2>Distribution for numerical variables</h2>
<p>To understand the distribution of key numerical variables in the
dataset, we selected six important metrics: “Annual Income (x1000)”,
“Monthly Electronics Spend”, “Annual Spending on Electronics”, “Age”,
“Monthly Household Spend”, and “Purchasing Frequency (every x months)”.
Histograms were generated for each of these variables, providing a
visual representation of their frequency distributions. The histograms
were created using the <code>ggplot2</code> package, with 20 bins for
each variable, and were color-coded for clarity. The plots were then
arranged in a grid for easy comparison and interpretation of the data
distributions.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Select numerical variables for visualization</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>numerical_variables <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;AnnualIncomex1000&quot;</span>, <span class="st">&quot;MonthlyElectronicsSpend&quot;</span>, </span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>                         <span class="st">&quot;Annualspendingonelectronics&quot;</span>, <span class="st">&quot;Age&quot;</span>, <span class="st">&quot;MonthlyHouseholdSpend&quot;</span>, </span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>                         <span class="st">&quot;PurchasingFrequencyeveryxmonths&quot;</span>)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co"># Create histograms for each numerical variable</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>histograms <span class="ot">&lt;-</span> <span class="fu">lapply</span>(numerical_variables, <span class="cf">function</span>(variable) {</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>  <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> .data[[variable]])) <span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">&quot;skyblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">bins =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Histogram of&quot;</span>, variable),</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>         <span class="at">x =</span> variable, <span class="at">y =</span> <span class="st">&quot;Frequency&quot;</span>)</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>})</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co"># Plot the histograms</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> histograms, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="pca-kmeans-clustering_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>[1] “ID” “Gender” “CodedGender” “MaritalStatus” “WorkStatus”<br />
[6] “Education” “Edcoded” “AnnualIncomex1000” “Age” “Location”<br />
[11] “PurchasingDecisionMaker” “PurchasingLocation” “PLcoded”
“MonthlyElectronicsSpend” “Annualspendingonelectronics”<br />
[16] “Spendingasofincome” “MonthlyHouseholdSpend”
“PurchasingFrequencyeveryxmonths” “TechnologyAdoption”
“TVViewinghoursday”<br />
[21] “Favoritefeature” “FFcoded”</p>
</div>
<div id="distribution-for-categorical-variables" class="section level2">
<h2>Distribution for categorical variables</h2>
<p>To analyze the distribution of categorical variables in the dataset,
we selected eight key categories: “Marital Status”, “Work Status”,
“Purchasing Decision Maker”, “Technology Adoption”, “Coded Gender”,
“Education Code (Edcoded)”, “Favorite Feature Code (FFcoded)”, and
“Product Loyalty Code (PLcoded)”. For each categorical variable, bar
plots were generated to visualize the frequency counts of each category.
The <code>ggplot2</code> package was used to create these bar plots,
with a consistent color scheme for clarity. The plots were arranged in a
2-column grid format to facilitate easy comparison and interpretation of
the data distributions across different categories.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Select categorical variables for visualization</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>categorical_variables <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;MaritalStatus&quot;</span>, <span class="st">&quot;WorkStatus&quot;</span>, <span class="st">&quot;PurchasingDecisionMaker&quot;</span>, <span class="st">&quot;TechnologyAdoption&quot;</span>,</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>                           <span class="st">&quot;CodedGender&quot;</span>, <span class="st">&quot;Edcoded&quot;</span>, <span class="st">&quot;FFcoded&quot;</span>, <span class="st">&quot;PLcoded&quot;</span>)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co"># Create bar plots for each categorical variable</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>bar_plots <span class="ot">&lt;-</span> <span class="fu">lapply</span>(categorical_variables, <span class="cf">function</span>(variable) {</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>  <span class="co"># Calculate counts for each category</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>  category_counts <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>    <span class="fu">count</span>(<span class="sc">!!</span><span class="fu">sym</span>(variable))</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>  <span class="co"># Create bar plot using ggplot2</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>  <span class="fu">ggplot</span>(category_counts, <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">!!</span><span class="fu">sym</span>(variable), <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;skyblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span>  <span class="co"># Use stat=&quot;identity&quot; for raw counts</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Bar Plot of&quot;</span>, variable),</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>         <span class="at">x =</span> variable, <span class="at">y =</span> <span class="st">&quot;Count&quot;</span>)</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>})</span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co"># Plot the bar plots in a 2-column grid</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> bar_plots, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="pca-kmeans-clustering_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="exploration-and-encoding-strategy-for-categorical-variables"
class="section level2">
<h2>Exploration and Encoding Strategy for Categorical Variables</h2>
<p>To understand the categorical variables in the dataset, we identified
the unique values for each categorical column. This involved selecting
columns with character data types and extracting their unique values. By
iterating through these columns and printing their unique values, we
gained insights into the distinct categories present in each variable.
This step was essential for determining the appropriate encoding
strategy to convert these categorical variables into a format suitable
for further analysis, such as one-hot encoding or label encoding.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Identify unique values for each categorical variable</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>unique_values <span class="ot">&lt;-</span> <span class="fu">lapply</span>(data[, <span class="fu">sapply</span>(data, is.character)], unique)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co"># Explore unique values and decide encoding strategy</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> <span class="fu">names</span>(unique_values)) {</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Unique values for&quot;</span>, col, <span class="st">&quot;:&quot;</span>, unique_values[[col]], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Unique values for Gender : male female 
## Unique values for MaritalStatus : married single 
## Unique values for WorkStatus : professional none 
## Unique values for Education : none BA PhD MA 
## Unique values for Location : Florida Alabama Massachusetts New York Montana New Jersey California New Hampshire Idaho Nevada Illinois Maine Alaska South Dakota Colorado Hawaii Washington Delaware Wyoming Rhode Island Pennsylvania Tennessee Missouri Vermont Oregon Connecticut North Carolina Maryland Nebraska Georgia Arkansas Arizona Iowa Kansas Ohio Louisiana North Dakota Kentucky New Mexico Texas South Carolina Utah Michigan West Virginia Wisconsin Indiana Virginia Mississippi Minnesota Oklahoma 
## Unique values for PurchasingDecisionMaker : family single 
## Unique values for PurchasingLocation : mass-consumer electronics specialty stores retail discount web (ebay) 
## Unique values for TechnologyAdoption : late early 
## Unique values for Favoritefeature : saving favorite shows to watch as a family time shifting cool gadget schedule control programming/interactive features</code></pre>
<p>[1] “ID” “Gender” “CodedGender” “MaritalStatus” “WorkStatus”<br />
[6] “Education” “Edcoded” “AnnualIncomex1000” “Age” “Location”<br />
[11] “PurchasingDecisionMaker” “PurchasingLocation” “PLcoded”
“MonthlyElectronicsSpend” “Annualspendingonelectronics”<br />
[16] “Spendingasofincome” “MonthlyHouseholdSpend”
“PurchasingFrequencyeveryxmonths” “TechnologyAdoption”
“TVViewinghoursday”<br />
[21] “Favoritefeature” “FFcoded”</p>
</div>
<div id="encoding-variables" class="section level2">
<h2>Encoding variables</h2>
<p>In this data processing workflow, the target mean encoding technique
effectively transformed the categorical Location variable into a
continuous numeric variable based on the mean of the
Monthly_Electronic_Spend. This method ensures that the “Location”
variable is represented in a manner suitable for subsequent
analysis.</p>
<p>Selected categorical variables—“Marital Status,” “Work Status,”
“Purchasing Decision Maker,” and “Technology Adoption”—were one-hot
encoded. This process converts these categorical values into binary
format, allowing them to be used in various machine learning algorithms.
Furthermore, the “TV Viewing (hours/day)” variable, an ordinal variable,
was scaled to normalize its values, making it ready for clustering and
other analytical methods. The <code>Location</code> variable was also
encoded using mapping.</p>
<p>The processed dataset was then combined with the original data,
incorporating the newly generated dummy variables and the scaled TV
viewing data. Following this, redundant columns were removed. These
included the original categorical columns that had been one-hot encoded,
the original “TV Viewing (hours/day)” column, “ID,” “Gender,” and
temporary columns created during frequency encoding. This cleanup
ensures the final dataset is streamlined and prepared for advanced
analysis.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Calculate the mean of Monthly_Electronic_Spend for each Location</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>mean_by_location <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="fu">group_by</span>(Location) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Location_mean =</span> <span class="fu">mean</span>(MonthlyElectronicsSpend, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co"># Replace Location with the mean target values</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>  <span class="fu">left_join</span>(mean_by_location, <span class="at">by =</span> <span class="st">&quot;Location&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Location) <span class="sc">%&gt;%</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Location_mean_encoding =</span> Location_mean)</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co"># Print the transformed data</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="fu">print</span>(data)</span></code></pre></div>
<pre><code>## # A tibble: 1,000 × 22
##       ID Gender CodedGender MaritalStatus WorkStatus   Education Edcoded AnnualIncomex1000   Age PurchasingDecisionMaker
##    &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;        &lt;chr&gt;       &lt;dbl&gt;             &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;                  
##  1     1 male             1 married       professional none            0                49    30 family                 
##  2     2 male             1 single        none         none            0                46    36 single                 
##  3     3 male             1 married       professional BA              1                58    66 family                 
##  4     4 male             1 married       none         PhD             3                51    78 family                 
##  5     5 female           0 single        none         none            0                46    52 single                 
##  6     6 female           0 married       none         BA              1                31    72 single                 
##  7     7 male             1 married       professional none            0                33    62 single                 
##  8     8 male             1 married       none         none            0                29    30 single                 
##  9     9 male             1 married       professional none            0                57    60 family                 
## 10    10 female           0 married       professional none            0                30    59 family                 
## # ℹ 990 more rows
## # ℹ 12 more variables: PurchasingLocation &lt;chr&gt;, PLcoded &lt;dbl&gt;, MonthlyElectronicsSpend &lt;dbl&gt;, Annualspendingonelectronics &lt;dbl&gt;,
## #   Spendingasofincome &lt;dbl&gt;, MonthlyHouseholdSpend &lt;dbl&gt;, PurchasingFrequencyeveryxmonths &lt;dbl&gt;, TechnologyAdoption &lt;chr&gt;,
## #   TVViewinghoursday &lt;dbl&gt;, Favoritefeature &lt;chr&gt;, FFcoded &lt;dbl&gt;, Location_mean_encoding &lt;dbl&gt;</code></pre>
<p>[1] “ID” “Gender” “CodedGender” “MaritalStatus” “WorkStatus”<br />
[6] “Education” “Edcoded” “AnnualIncomex1000” “Age” “Location”<br />
[11] “PurchasingDecisionMaker” “PurchasingLocation” “PLcoded”
“MonthlyElectronicsSpend” “Annualspendingonelectronics”<br />
[16] “Spendingasofincome” “MonthlyHouseholdSpend”
“PurchasingFrequencyeveryxmonths” “TechnologyAdoption”
“TVViewinghoursday”<br />
[21] “Favoritefeature” “FFcoded”</p>
</div>
<div id="encoding-categorical-and-ordinal-variables"
class="section level2">
<h2>Encoding Categorical and Ordinal Variables</h2>
<p>We performed the encoding of categorical and ordinal variables to
prepare the dataset for analysis. The steps involved were:</p>
<ol style="list-style-type: decimal">
<li><p><strong>One-Hot Encoding</strong>: We defined a function
<code>one_hot_encode</code> to convert categorical variables into
one-hot encoded variables. This function utilizes the
<code>dummyVars</code> function from the <code>caret</code> package to
create dummy variables. We applied this function to specific categorical
columns (<code>MaritalStatus</code>, <code>WorkStatus</code>,
<code>PurchasingDecisionMaker</code>, <code>TechnologyAdoption</code>),
generating a new dataframe with the encoded variables.</p></li>
<li><p><strong>Scaling an Ordinal Variable</strong>: We scaled the
ordinal variable <code>TVViewinghoursday</code> using standard scaling
(mean-centering and variance-scaling). This transformation ensures that
the variable has a mean of zero and a standard deviation of one, making
it suitable for further analysis such as Principal Component Analysis
(PCA).</p></li>
<li><p><strong>Combining Encoded Data</strong>: We combined the original
dataset, excluding the unwanted columns, with the one-hot encoded
variables and the scaled <code>TVViewinghoursday</code> variable. This
resulted in a final prepared dataset (<code>data_final</code>) that is
ready for subsequent analyses, such as clustering or PCA.</p></li>
</ol>
<p>These steps ensure that all variables are appropriately transformed,
facilitating accurate and meaningful analyses.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Define a function to perform one-hot encoding</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>one_hot_encode <span class="ot">&lt;-</span> <span class="cf">function</span>(data, cols) {</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  </span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>  dummy_model <span class="ot">&lt;-</span> <span class="fu">dummyVars</span>(<span class="sc">~</span>., <span class="at">data =</span> data[cols])</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>  dummy_data <span class="ot">&lt;-</span> <span class="fu">predict</span>(dummy_model, <span class="at">newdata =</span> data)</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.data.frame</span>(dummy_data))</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>}</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="co"># Encode categorical variables</span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>categorical_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;MaritalStatus&quot;</span>, <span class="st">&quot;WorkStatus&quot;</span>, <span class="st">&quot;PurchasingDecisionMaker&quot;</span>, <span class="st">&quot;TechnologyAdoption&quot;</span>)</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>encoded_data <span class="ot">&lt;-</span> <span class="fu">one_hot_encode</span>(data, categorical_cols)  <span class="co"># Use data_encoded here</span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co"># Encode ordinal variable (TV Viewing) using scaling</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>tv_viewing_scaled <span class="ot">&lt;-</span> <span class="fu">scale</span>(data<span class="sc">$</span>TVViewinghoursday, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)  <span class="co"># Use data_encoded here</span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="co"># Combine original data (exclude unwanted columns) with encoded variables and scaled TV viewing</span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a>data_final <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data[<span class="fu">setdiff</span>(<span class="fu">names</span>(data), <span class="fu">c</span>(categorical_cols, <span class="st">&quot;Education&quot;</span>, <span class="st">&quot;PurchasingLocation&quot;</span>, <span class="st">&quot;Favoritefeature&quot;</span>, <span class="st">&quot;Gender&quot;</span>, <span class="st">&quot;ID&quot;</span>,<span class="st">&quot;TVViewinghoursday&quot;</span>))], encoded_data, tv_viewing_scaled)</span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="co"># Display the encoded data with unwanted columns removed</span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a><span class="fu">head</span>(data_final)</span></code></pre></div>
<pre><code>##   CodedGender Edcoded AnnualIncomex1000 Age PLcoded MonthlyElectronicsSpend Annualspendingonelectronics Spendingasofincome
## 1           1       0                49  30       1                      35                         420        0.008571429
## 2           1       0                46  36       1                      35                         420        0.009130435
## 3           1       1                58  66       2                      64                         768        0.013241379
## 4           1       3                51  78       1                      33                         396        0.007764706
## 5           0       0                46  52       1                      45                         540        0.011739130
## 6           0       1                31  72       3                      14                         168        0.005419355
##   MonthlyHouseholdSpend PurchasingFrequencyeveryxmonths FFcoded Location_mean_encoding MaritalStatusmarried MaritalStatussingle
## 1                   150                              13       1               28.74286                    1                   0
## 2                   163                              26       1               33.83333                    0                   1
## 3                   103                              13       2               30.34211                    1                   0
## 4                   154                              22       1               32.56410                    1                   0
## 5                   161                              47       1               34.42857                    0                   1
## 6                    21                              32       2               30.48571                    1                   0
##   WorkStatusnone WorkStatusprofessional PurchasingDecisionMakerfamily PurchasingDecisionMakersingle TechnologyAdoptionearly
## 1              0                      1                             1                             0                       0
## 2              1                      0                             0                             1                       0
## 3              0                      1                             1                             0                       1
## 4              1                      0                             1                             0                       0
## 5              1                      0                             0                             1                       0
## 6              1                      0                             0                             1                       1
##   TechnologyAdoptionlate tv_viewing_scaled
## 1                      1        -0.1271367
## 2                      1         2.6217656
## 3                      0        -0.8143623
## 4                      1         0.9037017
## 5                      1        -0.1271367
## 6                      0        -0.4707495</code></pre>
</div>
<div id="feature-engineering-of-total-monthly-spend"
class="section level2">
<h2>Feature Engineering of Total Monthly Spend</h2>
<p>To enhance our dataset and provide more comprehensive insights, we
created a new feature called <code>Total_Monthly_Spend</code>. This was
achieved by summing up the <code>MonthlyElectronicsSpend</code> and
<code>MonthlyHouseholdSpend</code> for each record. The procedure was as
follows:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Column Existence Check</strong>: We verified the
existence of the necessary columns (<code>MonthlyElectronicsSpend</code>
and <code>MonthlyHouseholdSpend</code>) in the <code>data_final</code>
dataframe to ensure that they were available for the
calculation.</p></li>
<li><p><strong>Feature Creation</strong>: If both columns were present,
we created the new feature <code>Total_Monthly_Spend</code> by adding
the values of <code>MonthlyElectronicsSpend</code> and
<code>MonthlyHouseholdSpend</code>.</p></li>
</ol>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># Check if the necessary columns exist in the data_final dataframe</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="cf">if</span> (<span class="st">&quot;MonthlyElectronicsSpend&quot;</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(data_final) <span class="sc">&amp;&amp;</span> <span class="st">&quot;MonthlyHouseholdSpend&quot;</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(data_final)) {</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  <span class="co"># Create new feature: Total Monthly Spend</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  data_final<span class="sc">$</span>Total_Monthly_Spend <span class="ot">&lt;-</span> data_final<span class="sc">$</span>MonthlyElectronicsSpend <span class="sc">+</span> data_final<span class="sc">$</span>MonthlyHouseholdSpend</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>  <span class="co"># Print error message if the necessary columns are missing</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;Error: Required columns not found.&quot;</span>)</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>}</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="co"># Display data</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="fu">head</span>(data_final)</span></code></pre></div>
<pre><code>##   CodedGender Edcoded AnnualIncomex1000 Age PLcoded MonthlyElectronicsSpend Annualspendingonelectronics Spendingasofincome
## 1           1       0                49  30       1                      35                         420        0.008571429
## 2           1       0                46  36       1                      35                         420        0.009130435
## 3           1       1                58  66       2                      64                         768        0.013241379
## 4           1       3                51  78       1                      33                         396        0.007764706
## 5           0       0                46  52       1                      45                         540        0.011739130
## 6           0       1                31  72       3                      14                         168        0.005419355
##   MonthlyHouseholdSpend PurchasingFrequencyeveryxmonths FFcoded Location_mean_encoding MaritalStatusmarried MaritalStatussingle
## 1                   150                              13       1               28.74286                    1                   0
## 2                   163                              26       1               33.83333                    0                   1
## 3                   103                              13       2               30.34211                    1                   0
## 4                   154                              22       1               32.56410                    1                   0
## 5                   161                              47       1               34.42857                    0                   1
## 6                    21                              32       2               30.48571                    1                   0
##   WorkStatusnone WorkStatusprofessional PurchasingDecisionMakerfamily PurchasingDecisionMakersingle TechnologyAdoptionearly
## 1              0                      1                             1                             0                       0
## 2              1                      0                             0                             1                       0
## 3              0                      1                             1                             0                       1
## 4              1                      0                             1                             0                       0
## 5              1                      0                             0                             1                       0
## 6              1                      0                             0                             1                       1
##   TechnologyAdoptionlate tv_viewing_scaled Total_Monthly_Spend
## 1                      1        -0.1271367                 185
## 2                      1         2.6217656                 198
## 3                      0        -0.8143623                 167
## 4                      1         0.9037017                 187
## 5                      1        -0.1271367                 206
## 6                      0        -0.4707495                  35</code></pre>
</div>
<div id="feature-scaling-min-max-normalization" class="section level2">
<h2>Feature Scaling: Min-Max Normalization</h2>
<p>To prepare the data for further analysis, particularly for clustering
and dimensionality reduction techniques, we performed Min-Max scaling on
selected numerical features. The steps were as follows:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Selection of Features</strong>: Identified the features
to be scaled: <code>AnnualIncomex1000</code>,
<code>MonthlyElectronicsSpend</code>,
<code>Annualspendingonelectronics</code>, <code>Age</code>,
<code>MonthlyHouseholdSpend</code>,
<code>PurchasingFrequencyeveryxmonths</code>, and
<code>Total_Monthly_Spend</code>.</p></li>
<li><p><strong>Min-Max Scaling Function</strong>: Defined a function to
scale each feature to a range of 0 to 1 using the Min-Max normalization
technique, which transforms the data by subtracting the minimum value
and dividing by the range (max-min).</p></li>
<li><p><strong>Application of Scaling</strong>: Applied the Min-Max
scaling function to the specified features in the
<code>data_final</code> dataframe, resulting in a new dataframe
<code>data_final_scaled</code>.</p></li>
<li><p><strong>Verification</strong>: Checked the column names to ensure
that all specified features were present in the scaled dataframe and
confirmed the success of the scaling process.</p></li>
</ol>
<p>This scaling process ensures that all numerical features are on a
comparable scale, which is crucial for improving the performance of
machine learning algorithms and achieving more meaningful clustering
results.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># Specify the features to be scaled</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>features_to_scale <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;AnnualIncomex1000&quot;</span>, <span class="st">&quot;MonthlyElectronicsSpend&quot;</span>, <span class="st">&quot;Annualspendingonelectronics&quot;</span>, </span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>                       <span class="st">&quot;Age&quot;</span>, <span class="st">&quot;MonthlyHouseholdSpend&quot;</span>, <span class="st">&quot;PurchasingFrequencyeveryxmonths&quot;</span>, </span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>                       <span class="st">&quot;Total_Monthly_Spend&quot;</span>)</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="co"># Min-max scaling function</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>min_max_scaling <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>  (x <span class="sc">-</span> <span class="fu">min</span>(x)) <span class="sc">/</span> (<span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x))</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>}</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a><span class="co"># Apply min-max scaling to the specified features in the data_final dataframe</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>data_final_scaled <span class="ot">&lt;-</span> data_final</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>data_final_scaled[features_to_scale] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(data_final_scaled[features_to_scale], min_max_scaling)</span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a><span class="co"># Check column names in data_final_scaled</span></span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a><span class="fu">colnames</span>(data_final_scaled)</span></code></pre></div>
<pre><code>##  [1] &quot;CodedGender&quot;                     &quot;Edcoded&quot;                         &quot;AnnualIncomex1000&quot;              
##  [4] &quot;Age&quot;                             &quot;PLcoded&quot;                         &quot;MonthlyElectronicsSpend&quot;        
##  [7] &quot;Annualspendingonelectronics&quot;     &quot;Spendingasofincome&quot;              &quot;MonthlyHouseholdSpend&quot;          
## [10] &quot;PurchasingFrequencyeveryxmonths&quot; &quot;FFcoded&quot;                         &quot;Location_mean_encoding&quot;         
## [13] &quot;MaritalStatusmarried&quot;            &quot;MaritalStatussingle&quot;             &quot;WorkStatusnone&quot;                 
## [16] &quot;WorkStatusprofessional&quot;          &quot;PurchasingDecisionMakerfamily&quot;   &quot;PurchasingDecisionMakersingle&quot;  
## [19] &quot;TechnologyAdoptionearly&quot;         &quot;TechnologyAdoptionlate&quot;          &quot;tv_viewing_scaled&quot;              
## [22] &quot;Total_Monthly_Spend&quot;</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># Check if all features_to_scale are present in data_final_scaled</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="fu">all</span>(features_to_scale <span class="sc">%in%</span> <span class="fu">colnames</span>(data_final_scaled))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co"># Display the first few rows of the scaled dataframe</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="fu">head</span>(data_final_scaled)</span></code></pre></div>
<pre><code>##   CodedGender Edcoded AnnualIncomex1000       Age PLcoded MonthlyElectronicsSpend Annualspendingonelectronics Spendingasofincome
## 1           1       0        0.03949224 0.1935484       1              0.34567901                  0.34567901        0.008571429
## 2           1       0        0.03526093 0.2903226       1              0.34567901                  0.34567901        0.009130435
## 3           1       1        0.05218618 0.7741935       2              0.70370370                  0.70370370        0.013241379
## 4           1       3        0.04231312 0.9677419       1              0.32098765                  0.32098765        0.007764706
## 5           0       0        0.03526093 0.5483871       1              0.46913580                  0.46913580        0.011739130
## 6           0       1        0.01410437 0.8709677       3              0.08641975                  0.08641975        0.005419355
##   MonthlyHouseholdSpend PurchasingFrequencyeveryxmonths FFcoded Location_mean_encoding MaritalStatusmarried MaritalStatussingle
## 1            0.36842105                       0.2553191       1               28.74286                    1                   0
## 2            0.40263158                       0.5319149       1               33.83333                    0                   1
## 3            0.24473684                       0.2553191       2               30.34211                    1                   0
## 4            0.37894737                       0.4468085       1               32.56410                    1                   0
## 5            0.39736842                       0.9787234       1               34.42857                    0                   1
## 6            0.02894737                       0.6595745       2               30.48571                    1                   0
##   WorkStatusnone WorkStatusprofessional PurchasingDecisionMakerfamily PurchasingDecisionMakersingle TechnologyAdoptionearly
## 1              0                      1                             1                             0                       0
## 2              1                      0                             0                             1                       0
## 3              0                      1                             1                             0                       1
## 4              1                      0                             1                             0                       0
## 5              1                      0                             0                             1                       0
## 6              1                      0                             0                             1                       1
##   TechnologyAdoptionlate tv_viewing_scaled Total_Monthly_Spend
## 1                      1        -0.1271367          0.36681223
## 2                      1         2.6217656          0.39519651
## 3                      0        -0.8143623          0.32751092
## 4                      1         0.9037017          0.37117904
## 5                      1        -0.1271367          0.41266376
## 6                      0        -0.4707495          0.03930131</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">colnames</span>(data_final_scaled)</span></code></pre></div>
<pre><code>##  [1] &quot;CodedGender&quot;                     &quot;Edcoded&quot;                         &quot;AnnualIncomex1000&quot;              
##  [4] &quot;Age&quot;                             &quot;PLcoded&quot;                         &quot;MonthlyElectronicsSpend&quot;        
##  [7] &quot;Annualspendingonelectronics&quot;     &quot;Spendingasofincome&quot;              &quot;MonthlyHouseholdSpend&quot;          
## [10] &quot;PurchasingFrequencyeveryxmonths&quot; &quot;FFcoded&quot;                         &quot;Location_mean_encoding&quot;         
## [13] &quot;MaritalStatusmarried&quot;            &quot;MaritalStatussingle&quot;             &quot;WorkStatusnone&quot;                 
## [16] &quot;WorkStatusprofessional&quot;          &quot;PurchasingDecisionMakerfamily&quot;   &quot;PurchasingDecisionMakersingle&quot;  
## [19] &quot;TechnologyAdoptionearly&quot;         &quot;TechnologyAdoptionlate&quot;          &quot;tv_viewing_scaled&quot;              
## [22] &quot;Total_Monthly_Spend&quot;</code></pre>
</div>
</div>
<div id="visualisation" class="section level1">
<h1>Visualisation</h1>
<div id="visualisation-of-numerical-variables-box-plots"
class="section level2">
<h2>Visualisation of Numerical Variables: Box Plots</h2>
<p>In order to gain insights into the distribution and variability of
key numerical variables in our dataset, we selected several relevant
features for visualization. These include
<code>AnnualIncomex1000</code>, <code>MonthlyElectronicsSpend</code>,
<code>Annualspendingonelectronics</code>, <code>Age</code>,
<code>MonthlyHouseholdSpend</code>,
<code>PurchasingFrequencyeveryxmonths</code>, and
<code>Total_Monthly_Spend</code>.</p>
<p>Using the <code>ggplot2</code> library in R, we created box plots for
each of these numerical variables. Box plots are effective tools for
visualizing summary statistics such as median, quartiles, and potential
outliers. Each box plot represents the distribution of a numerical
variable, displaying the median (line inside the box), interquartile
range (box), and any outliers (points outside the whiskers).</p>
<p>The box plots were arranged in a 2-column grid layout for clear
comparison and interpretation. This visualization approach helps us
understand the spread and central tendency of these important numerical
features in our dataset, providing a foundation for further exploratory
data analysis and modeling.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="co"># Select numerical variables for visualization</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>numerical_variables <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;AnnualIncomex1000&quot;</span>, <span class="st">&quot;MonthlyElectronicsSpend&quot;</span>, <span class="st">&quot;Annualspendingonelectronics&quot;</span>,</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>                          <span class="st">&quot;Age&quot;</span>, <span class="st">&quot;MonthlyHouseholdSpend&quot;</span>, <span class="st">&quot;PurchasingFrequencyeveryxmonths&quot;</span>, <span class="st">&quot;Total_Monthly_Spend&quot;</span>)</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a><span class="co"># Create box plots for each numerical variable</span></span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>box_plots <span class="ot">&lt;-</span> <span class="fu">lapply</span>(numerical_variables, <span class="cf">function</span>(variable) {</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_final_scaled, <span class="fu">aes_string</span>(<span class="at">y =</span> variable)) <span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">&quot;skyblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Box Plot of&quot;</span>, variable),</span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> variable)</span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a>})</span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a><span class="co"># Plot the box plots in a 2-column grid</span></span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> box_plots, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="pca-kmeans-clustering_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="exploration-of-numerical-variables-scatter-plot-matrix"
class="section level2">
<h2>Exploration of Numerical Variables: Scatter Plot Matrix</h2>
<p>In this analysis, we focused on exploring the relationships and
distributions among key numerical variables extracted from our dataset.
The selected variables include <code>AnnualIncomex1000</code>,
<code>MonthlyElectronicsSpend</code>,
<code>Annualspendingonelectronics</code>, <code>Age</code>,
<code>MonthlyHouseholdSpend</code>,
<code>PurchasingFrequencyeveryxmonths</code>, and
<code>Total_Monthly_Spend</code>. Utilising the <code>ggpairs</code>
function from the <code>GGally</code> package in R, we constructed a
comprehensive scatter plot matrix. This matrix provides a visual
overview of pairwise interactions between these variables, presenting
scatter plots in a grid format. It allows us to assess both the strength
and direction of linear relationships through annotated correlation
coefficients in the upper diagonal panels, while the lower diagonal
panels show individual data points. Furthermore, the diagonal panels
display histograms or bar plots depicting the distributions of each
variable, facilitating insights into their data characteristics and
potential patterns.</p>
<p>This visualisation approach plays a crucial role in uncovering
insights that guide subsequent data analysis and modeling decisions. By
examining how these numerical features interrelate, we can identify
correlations, dependencies, and potential outliers that may influence
our analytical strategies. The scatter plot matrix serves as a
foundational tool in exploratory data analysis, helping to refine
feature selection, validate assumptions, and inform further
investigation into the underlying dynamics of our dataset.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="co"># Select numerical variables from your dataframe</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>numerical_variables <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;AnnualIncomex1000&quot;</span>, <span class="st">&quot;MonthlyElectronicsSpend&quot;</span>, <span class="st">&quot;Annualspendingonelectronics&quot;</span>,</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>                          <span class="st">&quot;Age&quot;</span>, <span class="st">&quot;MonthlyHouseholdSpend&quot;</span>, <span class="st">&quot;PurchasingFrequencyeveryxmonths&quot;</span>, <span class="st">&quot;Total_Monthly_Spend&quot;</span>)</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a><span class="co"># Create scatter plot matrix</span></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>scatter_matrix <span class="ot">&lt;-</span> <span class="fu">ggpairs</span>(data_final_scaled[numerical_variables], </span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>                          <span class="at">title =</span> <span class="st">&quot;Scatter Plot Matrix of Numerical Variables&quot;</span>,</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>                          <span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(<span class="st">&quot;cor&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>)),</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>                          <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(<span class="st">&quot;points&quot;</span>, <span class="at">color =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>)),</span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a>                          <span class="at">diag =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(<span class="st">&quot;barDiag&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)),</span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a>                          <span class="at">axisLabels =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">&quot;show&quot;</span>, <span class="at">discrete =</span> <span class="st">&quot;show&quot;</span>, </span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a>                                            <span class="at">x =</span> <span class="fu">list</span>(<span class="at">rot =</span> <span class="dv">45</span>, <span class="at">fontsize =</span> <span class="dv">8</span>))) <span class="sc">+</span> <span class="co"># Rotating x-axis labels by 45 degrees</span></span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a><span class="co"># Display the scatter plot matrix</span></span>
<span id="cb30-16"><a href="#cb30-16" tabindex="-1"></a>scatter_matrix</span></code></pre></div>
<pre><code>## plot: [1, 1] [=&gt;---------------------------------------------------------------------------------------------------] 2% est: 0s
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. plot: [1, 2]
## [===&gt;-------------------------------------------------------------------------------------------------] 4% est: 3s plot: [1, 3]
## [=====&gt;-----------------------------------------------------------------------------------------------] 6% est: 3s plot: [1, 4]
## [=======&gt;---------------------------------------------------------------------------------------------] 8% est: 3s plot: [1, 5]
## [=========&gt;-------------------------------------------------------------------------------------------] 10% est: 3s plot: [1, 6]
## [===========&gt;-----------------------------------------------------------------------------------------] 12% est: 3s plot: [1, 7]
## [=============&gt;---------------------------------------------------------------------------------------] 14% est: 3s plot: [2, 1]
## [===============&gt;-------------------------------------------------------------------------------------] 16% est: 3s plot: [2, 2]
## [==================&gt;----------------------------------------------------------------------------------] 18% est: 3s `stat_bin()`
## using `bins = 30`. Pick better value with `binwidth`. plot: [2, 3]
## [====================&gt;--------------------------------------------------------------------------------] 20% est: 3s plot: [2, 4]
## [======================&gt;------------------------------------------------------------------------------] 22% est: 3s plot: [2, 5]
## [========================&gt;----------------------------------------------------------------------------] 24% est: 2s plot: [2, 6]
## [==========================&gt;--------------------------------------------------------------------------] 27% est: 2s plot: [2, 7]
## [============================&gt;------------------------------------------------------------------------] 29% est: 2s plot: [3, 1]
## [==============================&gt;----------------------------------------------------------------------] 31% est: 2s plot: [3, 2]
## [================================&gt;--------------------------------------------------------------------] 33% est: 2s plot: [3, 3]
## [==================================&gt;------------------------------------------------------------------] 35% est: 2s `stat_bin()`
## using `bins = 30`. Pick better value with `binwidth`. plot: [3, 4]
## [====================================&gt;----------------------------------------------------------------] 37% est: 2s plot: [3, 5]
## [======================================&gt;--------------------------------------------------------------] 39% est: 2s plot: [3, 6]
## [========================================&gt;------------------------------------------------------------] 41% est: 2s plot: [3, 7]
## [==========================================&gt;----------------------------------------------------------] 43% est: 2s plot: [4, 1]
## [============================================&gt;--------------------------------------------------------] 45% est: 2s plot: [4, 2]
## [==============================================&gt;------------------------------------------------------] 47% est: 2s plot: [4, 3]
## [================================================&gt;----------------------------------------------------] 49% est: 2s plot: [4, 4]
## [===================================================&gt;-------------------------------------------------] 51% est: 2s `stat_bin()`
## using `bins = 30`. Pick better value with `binwidth`. plot: [4, 5]
## [=====================================================&gt;-----------------------------------------------] 53% est: 1s plot: [4, 6]
## [=======================================================&gt;---------------------------------------------] 55% est: 1s plot: [4, 7]
## [=========================================================&gt;-------------------------------------------] 57% est: 1s plot: [5, 1]
## [===========================================================&gt;-----------------------------------------] 59% est: 1s plot: [5, 2]
## [=============================================================&gt;---------------------------------------] 61% est: 1s plot: [5, 3]
## [===============================================================&gt;-------------------------------------] 63% est: 1s plot: [5, 4]
## [=================================================================&gt;-----------------------------------] 65% est: 1s plot: [5, 5]
## [===================================================================&gt;---------------------------------] 67% est: 1s `stat_bin()`
## using `bins = 30`. Pick better value with `binwidth`. plot: [5, 6]
## [=====================================================================&gt;-------------------------------] 69% est: 1s plot: [5, 7]
## [=======================================================================&gt;-----------------------------] 71% est: 1s plot: [6, 1]
## [=========================================================================&gt;---------------------------] 73% est: 1s plot: [6, 2]
## [===========================================================================&gt;-------------------------] 76% est: 1s plot: [6, 3]
## [=============================================================================&gt;-----------------------] 78% est: 1s plot: [6, 4]
## [===============================================================================&gt;---------------------] 80% est: 1s plot: [6, 5]
## [=================================================================================&gt;-------------------] 82% est: 1s plot: [6, 6]
## [====================================================================================&gt;----------------] 84% est: 0s `stat_bin()`
## using `bins = 30`. Pick better value with `binwidth`. plot: [6, 7]
## [======================================================================================&gt;--------------] 86% est: 0s plot: [7, 1]
## [========================================================================================&gt;------------] 88% est: 0s plot: [7, 2]
## [==========================================================================================&gt;----------] 90% est: 0s plot: [7, 3]
## [============================================================================================&gt;--------] 92% est: 0s plot: [7, 4]
## [==============================================================================================&gt;------] 94% est: 0s plot: [7, 5]
## [================================================================================================&gt;----] 96% est: 0s plot: [7, 6]
## [==================================================================================================&gt;--] 98% est: 0s plot: [7, 7]
## [=====================================================================================================]100% est: 0s `stat_bin()`
## using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="pca-kmeans-clustering_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="exploration-of-numerical-variables-correlation-analysis"
class="section level2">
<h2>Exploration of Numerical Variables: Correlation Analysis</h2>
<p>To examine the relationships between key numerical variables in our
dataset, we first isolated a subset of variables: <code>Age</code>,
<code>AnnualIncomex1000</code>, <code>MonthlyElectronicsSpend</code>,
<code>Annualspendingonelectronics</code>,
<code>MonthlyHouseholdSpend</code>,
<code>PurchasingFrequencyeveryxmonths</code>, and
<code>Total_Monthly_Spend</code>. These variables were selected from the
scaled and processed dataset <code>data_final_scaled</code>. Next, we
computed the correlation matrix using the <code>cor()</code> function in
R, which provided insights into how these variables are interrelated.
The correlation matrix captures pairwise correlations, revealing both
the strength and direction of linear relationships between variables. To
visualize these correlations effectively, we utilized the
<code>corrplot</code> package to generate a heatmap. This heatmap
highlights correlations using color intensity, with darker shades
indicating stronger correlations. Additionally, numeric values within
the heatmap cells and rotated axis labels aid in interpreting and
analyzing the correlation patterns among the selected numerical
variables.</p>
<p>This analytical approach is pivotal in understanding the inherent
associations within our dataset, guiding subsequent feature selection,
and informing modeling strategies. By visually summarising correlations
through a heatmap, we gain valuable insights that help validate
assumptions, identify potential multicollinearity issues, and prioritize
variables for further detailed analysis or predictive modeling
tasks.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="co"># Select numerical variables from your dataframe</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>numerical_vars <span class="ot">&lt;-</span> data_final_scaled[, <span class="fu">c</span>(<span class="st">&quot;Age&quot;</span>, <span class="st">&quot;AnnualIncomex1000&quot;</span>, <span class="st">&quot;MonthlyElectronicsSpend&quot;</span>, </span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>                                         <span class="st">&quot;Annualspendingonelectronics&quot;</span>, <span class="st">&quot;MonthlyHouseholdSpend&quot;</span>, </span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>                                         <span class="st">&quot;PurchasingFrequencyeveryxmonths&quot;</span>, <span class="st">&quot;Total_Monthly_Spend&quot;</span>)]</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a><span class="co"># Compute the correlation matrix</span></span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>correlation_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(numerical_vars)</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a><span class="co"># Plot the correlation matrix using a heatmap</span></span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a><span class="fu">corrplot</span>(correlation_matrix, <span class="at">method =</span> <span class="st">&quot;color&quot;</span>, <span class="at">type =</span> <span class="st">&quot;upper&quot;</span>, </span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a>         <span class="at">addCoef.col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">tl.col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">tl.srt =</span> <span class="dv">45</span>)</span></code></pre></div>
<p><img src="pca-kmeans-clustering_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="inspect-final-dataset" class="section level2">
<h2>Inspect final dataset</h2>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="co"># Display the first few rows of the scaled dataframe</span></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="fu">str</span>(data_final_scaled)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    1000 obs. of  22 variables:
##  $ CodedGender                    : num  1 1 1 1 0 0 1 1 1 0 ...
##  $ Edcoded                        : num  0 0 1 3 0 1 0 0 0 0 ...
##  $ AnnualIncomex1000              : num  0.0395 0.0353 0.0522 0.0423 0.0353 ...
##  $ Age                            : num  0.194 0.29 0.774 0.968 0.548 ...
##  $ PLcoded                        : num  1 1 2 1 1 3 4 3 2 4 ...
##  $ MonthlyElectronicsSpend        : num  0.346 0.346 0.704 0.321 0.469 ...
##  $ Annualspendingonelectronics    : num  0.346 0.346 0.704 0.321 0.469 ...
##  $ Spendingasofincome             : num  0.00857 0.00913 0.01324 0.00776 0.01174 ...
##  $ MonthlyHouseholdSpend          : num  0.368 0.403 0.245 0.379 0.397 ...
##  $ PurchasingFrequencyeveryxmonths: num  0.255 0.532 0.255 0.447 0.979 ...
##  $ FFcoded                        : num  1 1 2 1 1 2 3 4 4 4 ...
##  $ Location_mean_encoding         : num  28.7 33.8 30.3 32.6 34.4 ...
##  $ MaritalStatusmarried           : num  1 0 1 1 0 1 1 1 1 1 ...
##  $ MaritalStatussingle            : num  0 1 0 0 1 0 0 0 0 0 ...
##  $ WorkStatusnone                 : num  0 1 0 1 1 1 0 1 0 0 ...
##  $ WorkStatusprofessional         : num  1 0 1 0 0 0 1 0 1 1 ...
##  $ PurchasingDecisionMakerfamily  : num  1 0 1 1 0 0 0 0 1 1 ...
##  $ PurchasingDecisionMakersingle  : num  0 1 0 0 1 1 1 1 0 0 ...
##  $ TechnologyAdoptionearly        : num  0 0 1 0 0 1 1 1 1 1 ...
##  $ TechnologyAdoptionlate         : num  1 1 0 1 1 0 0 0 0 0 ...
##  $ tv_viewing_scaled              : num  -0.127 2.622 -0.814 0.904 -0.127 ...
##  $ Total_Monthly_Spend            : num  0.367 0.395 0.328 0.371 0.413 ...</code></pre>
</div>
</div>
<div id="principal-component-analysis-pca" class="section level1">
<h1>Principal Component Analysis (PCA)</h1>
<p>To uncover underlying patterns and reduce the dimensionality of our
dataset, we performed PCA on <code>data_final_scaled</code>. PCA
transforms correlated variables into a set of linearly uncorrelated
components, ordered by the amount of variance they explain. Using the
<code>prcomp()</code> function in R, PCA was conducted without centering
or scaling, as the data was already preprocessed. A summary of the PCA
results provided insights into the eigenvalues, showing the variance
captured by each principal component (PC). We visualized this variance
using bar plots, illustrating the percentage of total variance explained
by each PC. Additionally, a cumulative variance plot depicted how
successive PCs contribute to the overall variance explained, essential
for determining the optimal number of components to retain for
subsequent analyses.</p>
<p>This PCA analysis serves to condense complex data while preserving
its essential information, facilitating better understanding of the
dataset’s structure and potentially uncovering meaningful clusters or
patterns that can inform further statistical modeling or decision-making
processes.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="co"># Perform PCA on your data</span></span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a><span class="co"># Perform PCA on your data</span></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>pc <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(data_final_scaled, <span class="at">center =</span> <span class="cn">FALSE</span>, <span class="at">scale =</span> <span class="cn">FALSE</span>)</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a><span class="co"># Summary of the PCA results</span></span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a><span class="fu">summary</span>(pc)</span></code></pre></div>
<pre><code>## Importance of components:
##                            PC1     PC2    PC3     PC4     PC5     PC6     PC7     PC8     PC9   PC10    PC11    PC12    PC13
## Standard deviation     31.4973 1.89985 1.1399 0.84333 0.72338 0.67355 0.57935 0.50085 0.47074 0.3213 0.26677 0.25509 0.21591
## Proportion of Variance  0.9923 0.00361 0.0013 0.00071 0.00052 0.00045 0.00034 0.00025 0.00022 0.0001 0.00007 0.00007 0.00005
## Cumulative Proportion   0.9923 0.99589 0.9972 0.99790 0.99843 0.99888 0.99921 0.99947 0.99969 0.9998 0.99986 0.99993 0.99997
##                           PC14    PC15    PC16     PC17      PC18      PC19      PC20      PC21      PC22
## Standard deviation     0.12000 0.10305 0.03967 0.001167 1.373e-15 8.269e-16 3.287e-16 2.017e-16 2.106e-17
## Proportion of Variance 0.00001 0.00001 0.00000 0.000000 0.000e+00 0.000e+00 0.000e+00 0.000e+00 0.000e+00
## Cumulative Proportion  0.99999 1.00000 1.00000 1.000000 1.000e+00 1.000e+00 1.000e+00 1.000e+00 1.000e+00</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="co"># Percentage of variance explained by each principal component</span></span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>pc_var <span class="ot">&lt;-</span> pc<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sum</span>(pc<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a><span class="co"># Cumulative variance explained by principal components</span></span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>pc_cumvar <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(pc_var)</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a><span class="co"># Plot the variance explained by each principal component</span></span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a><span class="fu">barplot</span>(pc_var, <span class="at">main =</span> <span class="st">&quot;Variance Explained by Principal Components&quot;</span>,</span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Principal Component&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Percentage of Variance Explained&quot;</span>)</span></code></pre></div>
<p><img src="pca-kmeans-clustering_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="co"># Plot the cumulative variance explained by principal components</span></span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a><span class="fu">plot</span>(pc_cumvar, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Cumulative Variance Explained by Principal Components&quot;</span>,</span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Number of Principal Components&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Cumulative Percentage of Variance Explained&quot;</span>)</span></code></pre></div>
<p><img src="pca-kmeans-clustering_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<div id="pca-importance-of-components" class="section level2">
<h2>PCA Importance of Components</h2>
<p>With PC1 capturing over 99% of the variance, it is evident that this
component is the most significant and can potentially simplify the
dataset by reducing its dimensionality with minimal loss of information.
The subsequent components add negligible variance, suggesting that
beyond the first few principal components, additional components
contribute little to the overall variance</p>
</div>
<div id="applying-kaisers-criterion-to-pca-results"
class="section level2">
<h2>Applying Kaiser’s Criterion to PCA Results</h2>
<p>To determine the optimal number of principal components to retain
from our PCA analysis, we calculated the eigenvalues of the principal
components derived from <code>data_final_scaled</code>. The eigenvalues
represent the amount of variance explained by each principal component.
By examining these eigenvalues, we applied Kaiser’s criterion, which
suggests retaining components with eigenvalues greater than 1. After
computing the eigenvalues and filtering for those exceeding this
threshold, we identified the principal components that contribute
significantly to explaining the variability within our dataset. This
approach helps streamline our analysis by focusing on the most
informative components, adhering to Kaiser’s guideline for
dimensionality reduction in PCA.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="co"># Calculate eigenvalues</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>eigenvalues <span class="ot">&lt;-</span> pc<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a><span class="co"># Print the eigenvalues</span></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a><span class="fu">print</span>(eigenvalues)</span></code></pre></div>
<pre><code>##  [1] 9.920803e+02 3.609448e+00 1.299429e+00 7.112085e-01 5.232781e-01 4.536665e-01 3.356415e-01 2.508521e-01 2.215946e-01
## [10] 1.032128e-01 7.116588e-02 6.507146e-02 4.661679e-02 1.439984e-02 1.061943e-02 1.573999e-03 1.362529e-06 1.884056e-30
## [19] 6.837194e-31 1.080515e-31 4.069949e-32 4.433808e-34</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="co"># Filter eigenvalues greater than 1</span></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>optimal_components <span class="ot">&lt;-</span> eigenvalues[eigenvalues <span class="sc">&gt;</span> <span class="dv">1</span>]</span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a><span class="co"># Print the eigenvalues of principal components greater than 1</span></span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a><span class="fu">print</span>(optimal_components)</span></code></pre></div>
<pre><code>## [1] 992.080271   3.609448   1.299429</code></pre>
<p>The first principal component, with an eigenvalue of 992.080271,
captures the vast majority of the variability, while the second
(3.609448) and third (1.299429) components also contribute meaningfully
to the explanation of variance.</p>
</div>
<div id="analysing-variable-loadings-in-principal-components"
class="section level2">
<h2>Analysing Variable Loadings in Principal Components</h2>
<p>To understand the contribution of variables to each principal
component (PC), we extracted and analyzed variable loadings from the PCA
results performed on <code>data_final_scaled</code>. Variable loadings
indicate the strength and direction of each variable’s influence on the
principal components. We focused on the loadings for PC1 to PC3, as
these components typically capture the highest variance in the dataset.
Using <code>ggplot2</code>, we created bar plots that visually represent
the loadings of individual variables for each principal component. These
plots provide insights into which variables are most influential in
defining each principal component’s characteristics, aiding in the
interpretation of underlying patterns and relationships within our
data.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="co"># Perform PCA on your data</span></span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>pc <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(data_final_scaled, <span class="at">center =</span> <span class="cn">FALSE</span>, <span class="at">scale =</span> <span class="cn">FALSE</span>)</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a><span class="co"># Extract variable loadings for PC1 to PC4</span></span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>variable_loadings <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pc<span class="sc">$</span>rotation[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a><span class="co"># Function to create bar plot for variable loadings</span></span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a>create_bar_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(pc_num) {</span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a>  bar_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">variable =</span> <span class="fu">rownames</span>(variable_loadings),</span>
<span id="cb43-10"><a href="#cb43-10" tabindex="-1"></a>                         <span class="at">loading =</span> variable_loadings[, pc_num])</span>
<span id="cb43-11"><a href="#cb43-11" tabindex="-1"></a>  <span class="fu">ggplot</span>(bar_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(variable, loading), <span class="at">y =</span> loading)) <span class="sc">+</span></span>
<span id="cb43-12"><a href="#cb43-12" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;#0073C2FF&quot;</span>) <span class="sc">+</span></span>
<span id="cb43-13"><a href="#cb43-13" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb43-14"><a href="#cb43-14" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Variable Loadings for PC&quot;</span>, pc_num),</span>
<span id="cb43-15"><a href="#cb43-15" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Variable&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Loading&quot;</span>)</span>
<span id="cb43-16"><a href="#cb43-16" tabindex="-1"></a>}</span>
<span id="cb43-17"><a href="#cb43-17" tabindex="-1"></a></span>
<span id="cb43-18"><a href="#cb43-18" tabindex="-1"></a><span class="co"># Create bar plots for variable loadings of PC1 to PC4</span></span>
<span id="cb43-19"><a href="#cb43-19" tabindex="-1"></a>bar_plot_pc1 <span class="ot">&lt;-</span> <span class="fu">create_bar_plot</span>(<span class="dv">1</span>)</span>
<span id="cb43-20"><a href="#cb43-20" tabindex="-1"></a>bar_plot_pc2 <span class="ot">&lt;-</span> <span class="fu">create_bar_plot</span>(<span class="dv">2</span>)</span>
<span id="cb43-21"><a href="#cb43-21" tabindex="-1"></a>bar_plot_pc3 <span class="ot">&lt;-</span> <span class="fu">create_bar_plot</span>(<span class="dv">3</span>)</span>
<span id="cb43-22"><a href="#cb43-22" tabindex="-1"></a><span class="co">#bar_plot_pc4 &lt;- create_bar_plot(4)</span></span>
<span id="cb43-23"><a href="#cb43-23" tabindex="-1"></a></span>
<span id="cb43-24"><a href="#cb43-24" tabindex="-1"></a><span class="co"># Display the plots</span></span>
<span id="cb43-25"><a href="#cb43-25" tabindex="-1"></a>bar_plot_pc1</span></code></pre></div>
<p><img src="pca-kmeans-clustering_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>bar_plot_pc2</span></code></pre></div>
<p><img src="pca-kmeans-clustering_files/figure-html/unnamed-chunk-17-2.png" width="672" /></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>bar_plot_pc3</span></code></pre></div>
<p><img src="pca-kmeans-clustering_files/figure-html/unnamed-chunk-17-3.png" width="672" /></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="co">#bar_plot_pc4</span></span></code></pre></div>
</div>
<div id="principal-component-analysis-interpretation"
class="section level2">
<h2>Principal Component Analysis Interpretation</h2>
<p>The principal component analysis (PCA) conducted on
<code>data_final_scaled</code> revealed notable variable loadings across
several principal components (PCs). Specifically, the variable
<code>Location_encoded</code> exhibited a significant negative loading
on PC1, indicating that variations in this feature strongly influenced
the variance captured by PC1. Additionally, <code>FFcoded</code> and
<code>PLcoded</code> demonstrated pronounced positive loadings on PC2,
suggesting these variables contributed significantly to the patterns
observed along this principal component axis. Furthermore,
<code>Edcoded</code> exhibited strong negative loadings on PC3, implying
a distinct inverse relationship between this variable and the variance
explained by PC3. These findings highlight the distinct roles these
variables play in defining the multidimensional structure and variance
distribution within the dataset, offering valuable insights into the
underlying factors driving data variability.</p>
</div>
<div id="visualization-of-principal-component-analysis-pca-results"
class="section level2">
<h2>Visualization of Principal Component Analysis (PCA) Results</h2>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="co"># Extract PCA components for clustering</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>pca_data <span class="ot">&lt;-</span> pc<span class="sc">$</span>x  <span class="co"># Assuming pc is the result of your PCA analysis</span></span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a><span class="co"># Visualize PCA results (scatter plot)</span></span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a>pca_scatter <span class="ot">&lt;-</span> <span class="fu">fviz_pca_ind</span>(pc, <span class="at">geom.ind =</span> <span class="st">&quot;point&quot;</span>, </span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a>                            <span class="at">pointshape =</span> <span class="dv">21</span>, <span class="at">palette =</span> <span class="st">&quot;jco&quot;</span>, </span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a>                            <span class="at">addEllipses =</span> <span class="cn">TRUE</span>, <span class="at">ellipse.level =</span> <span class="fl">0.95</span>, </span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a>                            <span class="at">repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb47-9"><a href="#cb47-9" tabindex="-1"></a>              <span class="fu">ggtitle</span>(<span class="st">&quot;PCA Visualization&quot;</span>)</span>
<span id="cb47-10"><a href="#cb47-10" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" tabindex="-1"></a><span class="co"># Variable representation (arrows)</span></span>
<span id="cb47-12"><a href="#cb47-12" tabindex="-1"></a>var_representation <span class="ot">&lt;-</span> <span class="fu">fviz_pca_var</span>(pc, <span class="at">col.var =</span> <span class="st">&quot;contrib&quot;</span>, </span>
<span id="cb47-13"><a href="#cb47-13" tabindex="-1"></a>                                    <span class="at">gradient.cols =</span> <span class="fu">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#FC4E07&quot;</span>), </span>
<span id="cb47-14"><a href="#cb47-14" tabindex="-1"></a>                                    <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="at">axes =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">arrows =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb47-15"><a href="#cb47-15" tabindex="-1"></a>                      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Variable Representation&quot;</span>)</span>
<span id="cb47-16"><a href="#cb47-16" tabindex="-1"></a></span>
<span id="cb47-17"><a href="#cb47-17" tabindex="-1"></a><span class="co"># Combine plots</span></span>
<span id="cb47-18"><a href="#cb47-18" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> <span class="fu">grid.arrange</span>(pca_scatter, var_representation, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="pca-kmeans-clustering_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="co"># Save PCA scatter plot as standalone image</span></span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;pca_scatter_plot.png&quot;</span>, pca_scatter, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a><span class="co"># Save variable representation plot as standalone image</span></span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;variable_representation_plot.png&quot;</span>, var_representation, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>)</span></code></pre></div>
<p>Location_coded has a higher lenght of vector and contributes
significantly in the PCA model.FFcode and PLcoded also show some
significant contribution.</p>
</div>
</div>
<div id="determine-optimal-number-of-clusters" class="section level1">
<h1>Determine optimal number of clusters</h1>
<div id="elbow-method" class="section level2">
<h2>Elbow Method</h2>
<p>To determine the optimal number of clusters for clustering analysis
based on principal component scores, the elbow method was employed. The
function <code>elbow_method</code> iteratively applied the k-means
algorithm to the PCA-transformed data, assessing a range of cluster
numbers from 1 to 10. For each iteration, the total within-cluster sum
of squares (WSS) was computed and plotted against the number of
clusters. The resulting plot displayed a distinctive “elbow” point where
the rate of decrease in WSS slowed, indicating that adding more clusters
beyond this point would not significantly reduce WSS. This elbow point
serves as a heuristic for selecting the optimal number of clusters,
providing insight into the inherent structure and clustering tendencies
within the data set.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="co"># Elbow Method</span></span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a>elbow_method <span class="ot">&lt;-</span> <span class="cf">function</span>(pca_data, max_k) {</span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a>  wss <span class="ot">&lt;-</span> <span class="fu">numeric</span>(max_k)</span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_k) {</span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>    kmeans_model <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(pca_data, <span class="at">centers =</span> i, <span class="at">nstart =</span> <span class="dv">10</span>)</span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a>    wss[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(kmeans_model<span class="sc">$</span>tot.withinss)</span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a>  }</span>
<span id="cb49-8"><a href="#cb49-8" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span>max_k, wss, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Number of Clusters (k)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Total Within Sum of Squares (WSS)&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Elbow Method&quot;</span>)</span>
<span id="cb49-9"><a href="#cb49-9" tabindex="-1"></a>}</span>
<span id="cb49-10"><a href="#cb49-10" tabindex="-1"></a></span>
<span id="cb49-11"><a href="#cb49-11" tabindex="-1"></a><span class="co"># Call elbow_method function</span></span>
<span id="cb49-12"><a href="#cb49-12" tabindex="-1"></a><span class="fu">elbow_method</span>(pca_data, <span class="at">max_k =</span> <span class="dv">10</span>)</span></code></pre></div>
<p><img src="pca-kmeans-clustering_files/figure-html/unnamed-chunk-19-1.png" width="672" />
Elbow point is between 5 and 6 clusters. Other methods below will assist
in making a definite decision.</p>
</div>
<div id="silhouette-method" class="section level2">
<h2>Silhouette Method</h2>
<p>To determine the optimal number of clusters for the dataset using
principal component scores, the silhouette method was employed. The
function <code>silhouette_method</code> iteratively applied the k-means
algorithm with varying numbers of clusters (from 2 to 10) to the
PCA-transformed data. For each iteration, the silhouette width was
computed for each data point, representing how similar each point is to
its own cluster compared to other clusters. The average silhouette width
across all data points for each cluster configuration was then plotted
against the number of clusters. The resulting plot provided insight into
the optimal number of clusters by identifying peaks in the silhouette
scores, indicating well-defined clusters where data points are
appropriately clustered relative to their own and neighboring clusters.
This method aids in selecting an optimal clustering solution that
maximizes intra-cluster cohesion and inter-cluster separation.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="co"># Silhouette Method</span></span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a>silhouette_method <span class="ot">&lt;-</span> <span class="cf">function</span>(pca_data, max_k) {</span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>  silhouette_scores <span class="ot">&lt;-</span> <span class="fu">numeric</span>(max_k)</span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>max_k) {</span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a>    kmeans_model <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(pca_data, <span class="at">centers =</span> i, <span class="at">nstart =</span> <span class="dv">10</span>)</span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a>    silhouette_obj <span class="ot">&lt;-</span> <span class="fu">silhouette</span>(kmeans_model<span class="sc">$</span>cluster, <span class="fu">dist</span>(pca_data))</span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a>    silhouette_scores[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(silhouette_obj[, <span class="st">&quot;sil_width&quot;</span>])</span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a>  }</span>
<span id="cb50-9"><a href="#cb50-9" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="dv">2</span><span class="sc">:</span>max_k, silhouette_scores[<span class="dv">2</span><span class="sc">:</span>max_k], <span class="at">type =</span> <span class="st">&quot;b&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Number of Clusters (k)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Silhouette Score&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Silhouette Method&quot;</span>)</span>
<span id="cb50-10"><a href="#cb50-10" tabindex="-1"></a>}</span>
<span id="cb50-11"><a href="#cb50-11" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" tabindex="-1"></a><span class="co"># Call silhouette_method function</span></span>
<span id="cb50-13"><a href="#cb50-13" tabindex="-1"></a><span class="fu">silhouette_method</span>(pca_data, <span class="at">max_k =</span> <span class="dv">10</span>)</span></code></pre></div>
<p><img src="pca-kmeans-clustering_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>Silhouette Method shows 6 clusters.</p>
</div>
<div id="gap-statistics" class="section level2">
<h2>Gap Statistics</h2>
<p>The gap statistic method was applied to determine the optimal number
of clusters in the dataset using principal component analysis (PCA). The
function <code>gap_statistics</code> was developed to calculate the gap
statistic for varying numbers of clusters (from 2 to 10). This method
compares the total within-cluster variation with its expected variation
under null reference distribution of the data. For each cluster
configuration, the k-means algorithm was employed with multiple starts
to compute the gap statistic. Additionally, the function utilized the
<code>clusGap</code> function from the <code>cluster</code> package to
compute the gap statistic, which identifies the optimal number of
clusters as the value of <span class="math inline">\(k\)</span> that
maximizes the gap statistic. The resulting plot displayed the gap
statistic values against the number of clusters, assisting in the
selection of the most suitable clustering solution that maximizes
distinctiveness between clusters while maintaining compactness within
each cluster.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a>gap_statistics <span class="ot">&lt;-</span> <span class="cf">function</span>(pca_data, max_k, <span class="at">B =</span> <span class="dv">10</span>) {</span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a>  gap <span class="ot">&lt;-</span> <span class="fu">numeric</span>(max_k <span class="sc">-</span> <span class="dv">1</span>)  <span class="co"># Initialize with length max_k - 1</span></span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>max_k) {  <span class="co"># Start from 2 instead of 1</span></span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Calculating gap statistic for k =&quot;</span>, i))</span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a>    kmeans_model <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(pca_data, <span class="at">centers =</span> i, <span class="at">nstart =</span> <span class="dv">10</span>)</span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a>    gap_result <span class="ot">&lt;-</span> <span class="fu">clusGap</span>(pca_data, <span class="at">FUNcluster =</span> kmeans, <span class="at">K.max =</span> i, <span class="at">B =</span> B)</span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a>    gap[i <span class="sc">-</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">max</span>(gap_result<span class="sc">$</span>Tab[, <span class="st">&quot;gap&quot;</span>])  <span class="co"># Use maximum gap value</span></span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a>  }</span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="dv">2</span><span class="sc">:</span>max_k, gap, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Number of Clusters (k)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Gap Statistic&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Gap Statistics&quot;</span>)</span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a>}</span>
<span id="cb51-11"><a href="#cb51-11" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" tabindex="-1"></a><span class="co"># Call gap_statistics function</span></span>
<span id="cb51-13"><a href="#cb51-13" tabindex="-1"></a><span class="fu">gap_statistics</span>(pca_data, <span class="at">max_k =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Calculating gap statistic for k = 2&quot;
## Clustering k = 1,2,..., K.max (= 2): .. done
## Bootstrapping, b = 1,2,..., B (= 10)  [one &quot;.&quot; per sample]:
## .......... 10 
## [1] &quot;Calculating gap statistic for k = 3&quot;
## Clustering k = 1,2,..., K.max (= 3): .. done
## Bootstrapping, b = 1,2,..., B (= 10)  [one &quot;.&quot; per sample]:
## .......... 10 
## [1] &quot;Calculating gap statistic for k = 4&quot;
## Clustering k = 1,2,..., K.max (= 4): .. done
## Bootstrapping, b = 1,2,..., B (= 10)  [one &quot;.&quot; per sample]:
## .......... 10 
## [1] &quot;Calculating gap statistic for k = 5&quot;
## Clustering k = 1,2,..., K.max (= 5): .. done
## Bootstrapping, b = 1,2,..., B (= 10)  [one &quot;.&quot; per sample]:
## .......... 10 
## [1] &quot;Calculating gap statistic for k = 6&quot;
## Clustering k = 1,2,..., K.max (= 6): .. done
## Bootstrapping, b = 1,2,..., B (= 10)  [one &quot;.&quot; per sample]:
## .......... 10 
## [1] &quot;Calculating gap statistic for k = 7&quot;
## Clustering k = 1,2,..., K.max (= 7): .. done
## Bootstrapping, b = 1,2,..., B (= 10)  [one &quot;.&quot; per sample]:
## .......... 10 
## [1] &quot;Calculating gap statistic for k = 8&quot;
## Clustering k = 1,2,..., K.max (= 8): .. done
## Bootstrapping, b = 1,2,..., B (= 10)  [one &quot;.&quot; per sample]:
## .......... 10 
## [1] &quot;Calculating gap statistic for k = 9&quot;
## Clustering k = 1,2,..., K.max (= 9): .. done
## Bootstrapping, b = 1,2,..., B (= 10)  [one &quot;.&quot; per sample]:
## .......... 10 
## [1] &quot;Calculating gap statistic for k = 10&quot;
## Clustering k = 1,2,..., K.max (= 10): .. done
## Bootstrapping, b = 1,2,..., B (= 10)  [one &quot;.&quot; per sample]:
## .......... 10</code></pre>
<p><img src="pca-kmeans-clustering_files/figure-html/unnamed-chunk-21-1.png" width="672" />
Gap Statistics shows 6 clusters.Therefore 6 clusters were selected for
segmentation.</p>
</div>
</div>
<div id="k-means-clustering-with-k-6" class="section level1">
<h1>K-means Clustering with K = 6</h1>
<p>K-means clustering was then performed on the PC scores using the
<code>kmeans</code> function, specifying 6 clusters (<code>K = 6</code>)
and 10 random starts to ensure robustness of the clustering results. The
clustering results (<code>kmeans_result</code>) assigned each data point
to one of the six clusters based on their proximity in the PC space.</p>
<p>To visualize the clustering outcome, a scatter plot was created using
<code>ggplot2</code>, where each data point was plotted based on its
coordinates in the first two principal components (<code>PC1</code> and
<code>PC2</code>). Points were color-coded according to their cluster
assignment (<code>factor(kmeans_result$cluster)</code>), facilitating
visual interpretation of cluster separation and distribution. The plot
title, axis labels, and legend were appropriately annotated to aid in
understanding the K-means clustering results derived from PCA.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="co"># Perform PCA on your data</span></span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a>pc <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(data_final_scaled, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a><span class="co"># Extract PC scores for PC1 to PC2</span></span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a>pc_scores <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pc<span class="sc">$</span>x[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a><span class="co"># Perform K-means clustering with K = 5 using PCA results</span></span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a>kmeans_result <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(pc_scores, <span class="at">centers =</span> <span class="dv">6</span>, <span class="at">nstart =</span> <span class="dv">10</span>)</span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a><span class="co"># Visualize the clusters</span></span>
<span id="cb53-11"><a href="#cb53-11" tabindex="-1"></a><span class="fu">ggplot</span>(pc_scores, <span class="fu">aes</span>(<span class="at">x =</span> PC1, <span class="at">y =</span> PC2, <span class="at">color =</span> <span class="fu">factor</span>(kmeans_result<span class="sc">$</span>cluster))) <span class="sc">+</span></span>
<span id="cb53-12"><a href="#cb53-12" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb53-13"><a href="#cb53-13" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Cluster&quot;</span>) <span class="sc">+</span></span>
<span id="cb53-14"><a href="#cb53-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;K-means Clustering Results (K = 6)&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Principal Component 1&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Principal Component 2&quot;</span>)</span></code></pre></div>
<p><img src="pca-kmeans-clustering_files/figure-html/unnamed-chunk-22-1.png" width="672" />
## K-means fviz plot</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="co"># Perform PCA on your data</span></span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a>pc <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(data_final_scaled, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale. =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a><span class="co"># Extract PC scores for PC1 to PC3</span></span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a>pc_scores <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pc<span class="sc">$</span>x[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb54-6"><a href="#cb54-6" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" tabindex="-1"></a><span class="co"># Perform K-means clustering with K = 6 using PCA results</span></span>
<span id="cb54-8"><a href="#cb54-8" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># Setting seed for reproducibility</span></span>
<span id="cb54-9"><a href="#cb54-9" tabindex="-1"></a>kmeans_result <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(pc_scores, <span class="at">centers =</span> <span class="dv">6</span>, <span class="at">nstart =</span> <span class="dv">10</span>)</span>
<span id="cb54-10"><a href="#cb54-10" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" tabindex="-1"></a><span class="co"># Visualize the clusters using fviz</span></span>
<span id="cb54-12"><a href="#cb54-12" tabindex="-1"></a><span class="fu">fviz_cluster</span>(kmeans_result, <span class="at">data =</span> pc_scores, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, </span>
<span id="cb54-13"><a href="#cb54-13" tabindex="-1"></a>             <span class="at">ellipse.type =</span> <span class="st">&quot;convex&quot;</span>, </span>
<span id="cb54-14"><a href="#cb54-14" tabindex="-1"></a>             <span class="at">palette =</span> <span class="st">&quot;jco&quot;</span>, </span>
<span id="cb54-15"><a href="#cb54-15" tabindex="-1"></a>             <span class="at">ggtheme =</span> <span class="fu">theme_minimal</span>(),</span>
<span id="cb54-16"><a href="#cb54-16" tabindex="-1"></a>             <span class="at">main =</span> <span class="st">&quot;K-means Clustering Results (K = 6)&quot;</span>)</span></code></pre></div>
<p><img src="pca-kmeans-clustering_files/figure-html/unnamed-chunk-23-1.png" width="672" />
There is an overlap between clusters, especially cluster 3, 4 and 6
while cluster 1 and 2 are slightly isolated from other clusters but
overlap with each other. Cluster 5 also appear to be independent. It
should be noted that 2D images do not represent the whole picture.</p>
<div id="d-visualization-of-clusters" class="section level2">
<h2>3D Visualization of clusters</h2>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="co"># Visualize the clusters in 3D</span></span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">data =</span> pc_scores, <span class="at">x =</span> <span class="sc">~</span>PC1, <span class="at">y =</span> <span class="sc">~</span>PC2, <span class="at">z =</span> <span class="sc">~</span>PC3, <span class="at">color =</span> <span class="fu">factor</span>(kmeans_result<span class="sc">$</span>cluster), </span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;scatter3d&quot;</span>, <span class="at">mode =</span> <span class="st">&quot;markers&quot;</span>, <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">6</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">&quot;K-means Clustering Results (K = 6)&quot;</span>,</span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a>         <span class="at">scene =</span> <span class="fu">list</span>(<span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;Principal Component 1&quot;</span>),</span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a>                      <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;Principal Component 2&quot;</span>),</span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a>                      <span class="at">zaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;Principal Component 3&quot;</span>)))</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-4b3e8cd160f85a982514" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-4b3e8cd160f85a982514">{"x":{"visdat":{"cb204589d811":["function () ","plotlyVisDat"]},"cur_data":"cb204589d811","attrs":{"cb204589d811":{"x":{},"y":{},"z":{},"mode":"markers","marker":{"size":6},"color":["4","4","5","4","4","6","6","6","5","3","1","4","5","6","6","3","6","3","1","3","4","6","4","4","1","6","6","3","4","3","2","6","6","3","4","4","6","6","1","3","1","5","6","6","6","6","3","5","1","3","3","3","6","1","6","6","6","3","4","5","6","4","4","3","1","1","1","6","3","3","6","3","5","3","4","4","1","6","5","1","6","6","6","5","6","6","4","6","1","6","4","6","6","1","5","4","4","1","3","4","1","4","5","3","3","6","6","3","5","6","6","2","3","6","6","4","4","5","6","3","6","3","1","4","6","5","4","3","6","3","6","1","6","5","3","4","6","4","5","4","4","3","3","4","6","1","5","5","6","3","6","5","4","4","5","1","1","4","5","3","2","3","6","6","6","5","4","4","6","4","4","5","5","1","3","3","4","6","4","1","3","3","4","6","1","6","6","5","5","3","1","4","1","1","3","6","3","5","4","3","4","3","6","5","3","6","6","5","3","6","1","6","6","3","6","4","6","5","6","1","5","6","6","6","5","6","4","1","4","4","1","3","4","4","3","4","4","1","3","4","3","6","5","5","2","3","5","6","4","6","1","4","6","2","3","1","5","3","4","5","1","2","6","4","6","6","4","3","1","6","5","3","6","3","4","4","6","3","6","5","6","3","4","3","4","4","3","3","4","3","4","6","5","1","6","1","1","6","6","1","6","4","3","4","2","5","3","6","2","1","6","4","6","6","3","6","6","6","1","6","4","3","2","3","4","4","6","3","5","6","1","6","6","6","1","1","1","5","6","4","3","1","5","6","6","4","6","6","2","1","6","5","1","4","4","6","5","6","3","5","6","5","1","3","6","6","3","5","4","5","3","6","6","4","6","1","1","6","2","1","6","6","1","6","2","5","6","4","6","5","1","6","6","5","1","6","4","3","6","5","6","1","3","4","4","1","1","3","4","6","2","6","3","5","6","4","1","3","3","5","6","3","3","5","6","1","1","5","1","4","6","3","1","6","4","3","4","3","4","4","5","5","3","4","5","3","5","1","1","6","4","6","1","6","4","5","1","4","6","6","6","1","4","4","5","4","5","6","6","5","6","6","6","4","3","3","3","1","5","6","6","5","4","4","4","6","3","4","1","4","3","4","6","3","4","1","5","3","5","5","6","6","3","3","3","6","6","5","4","6","1","6","5","6","1","3","4","1","3","3","3","4","3","2","1","1","6","6","1","5","6","1","5","3","3","5","4","6","3","3","6","3","4","6","6","4","6","6","4","6","6","1","6","6","4","1","1","4","1","5","6","5","6","6","1","3","1","5","4","3","2","6","3","6","6","4","1","4","3","4","3","6","3","4","6","6","4","5","6","4","4","1","6","3","6","3","5","4","3","6","6","3","1","6","3","6","3","3","1","5","4","5","3","6","5","6","3","3","3","5","6","2","5","3","6","3","4","6","2","1","6","1","6","3","4","1","5","3","6","5","1","3","2","5","3","4","4","5","4","6","4","3","4","6","1","6","6","1","6","3","3","4","5","3","4","4","6","3","6","4","5","6","6","3","5","4","3","3","1","4","3","3","3","5","6","4","3","6","6","6","1","6","4","6","3","1","3","3","3","5","3","2","3","6","5","6","6","1","6","4","5","6","1","3","6","3","3","1","6","6","3","4","3","4","6","6","6","6","1","6","3","5","4","4","4","6","1","6","4","3","4","6","5","1","4","1","4","5","4","6","3","4","3","6","4","4","3","3","4","3","1","1","4","4","6","6","6","6","4","4","6","3","1","3","5","5","6","4","3","4","6","4","6","5","1","5","5","6","6","1","1","6","4","5","1","3","6","1","6","1","5","1","4","6","3","1","1","2","3","1","3","4","4","1","5","6","6","3","3","3","3","6","6","6","4","3","5","4","4","4","4","5","1","1","1","6","2","3","5","6","6","6","6","3","4","1","4","6","5","3","4","4","6","6","6","6","6","1","5","6","3","4","4","6","6","1","2","5","6","3","4","4","4","1","1","3","4","6","4","5","4","1","6","5","2","4","6","1","5","1","3","4","1","3","4","4","6","6","5","1","6","6","2","6","5","1","6","6","1","3","6","1","4","4","6","4","3","1","3","6","6","1","5","4","6","6","1","3","5","3","6","1","4","6","6","4","3","6","3","3","6","5","4","3","6","1","6","3","3","4","1","3","6","6","4","1","3","6","2","6","1","3","5","5","6","6","1","4","1","3","4","5","3","6","6","4","4","6","1","6","3","3","6","6","3","6","4","1","4","6","3","3","1","6","5","6","6","6","4","6"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"K-means Clustering Results (K = 6)","scene":{"xaxis":{"title":"Principal Component 1"},"yaxis":{"title":"Principal Component 2"},"zaxis":{"title":"Principal Component 3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[0.46743640597649883,1.148912171811193,0.62760704293413117,0.76707082617051858,1.5641405956607817,0.97507246608416731,1.5069000633707086,1.7616056433379814,0.82457750808929275,1.4351837587823746,-0.62368307542976675,0.89988189851183098,2.4293569717974104,0.31247155518154424,1.9732471596001948,-0.78169741158934758,1.2673627855720495,1.7592634956805695,0.37543727151985135,0.20409379434862468,1.0554111839023306,0.9823996338889428,0.19446911892581298,1.6472445843993149,-0.019466280958354121,0.57885250010036415,1.386505966499147,0.63873415703334302,0.64773884004379956,2.4078761956599801,1.2120333463687663,0.92866645522879709,0.72292727038634041,0.93198134686530076,-0.074585494523409179,2.2623418644502391,1.3365610094881606,1.4260005034435066,0.46736501390110885,2.0686891001189704,0.84640855288876127,0.59978127633321465,1.5122336382700534,0.45331317467368021,1.7059301561034814,-0.40756932384224853,0.76064974415963571,0.37887670855698719,1.0028151716858191,0.77551622189205216,1.6236368181582113,0.38944359895607528,1.1834783423113691,-0.073983829679008656,0.77234796766556402,0.21402924037272925,2.0043529656150172,0.77509667858886155,0.92499062039401625,-0.26002146724333425,1.3919843060565487,1.1810019602846886,0.83395990670610365,1.1078122956523617,2.1093380283704595,0.56794289879372617,1.8107435489768369,0.53208238486543347,0.83996725642739323,0.96109541717567881,0.65237451442778394,-0.34340251047490117,1.701046201932779,1.9504087886410897,-0.64732279716303054,0.070224054575444006,-1.1002902890547852,1.1921263446408863,1.8322570292852118,0.70686248519741335,0.94710161979503837,1.3911124660883321,1.7025352530972762,0.99441307379386923,0.59021963400018529,0.5717621651989242,1.7645368352064077,0.4605522380425881,2.1750636450461873,2.3920595277471897,1.6555815771342772,1.5295341871194983,1.1822589188591841,1.2835639294127519,1.0319804096892393,0.15971144760253422,1.4834974797608038,1.1376286327283585,1.8832537773837341,0.16390623768364768,1.2415198776171359,1.5088981685289955,0.38079413333509338,0.8350630708765413,1.3489493559391297,0.86205421100773871,0.76958156375850628,-0.55303549403428831,0.5797069900433085,1.0798272597186973,0.97262965125460898,0.37401970905081311,-0.83765667939875399,0.32729727801886194,0.56731530108996409,0.34490760698527861,1.5754859256224338,1.0807607372008676,-0.62851116649947103,0.051617889110761872,1.5516433183028839,-0.59053692655770196,0.87725112147925688,1.0456090149860817,1.6213608733279929,0.17914193498606196,0.82133114446044475,1.1879349801584229,1.7872355167202889,0.28202785854556212,1.1336733805379706,-0.66429419846329751,1.2589764753040953,0.69875307330407488,1.0935573933686193,1.0600603906954229,1.5913484857445064,0.92239519532416281,1.6178873088386931,1.1780496252831614,1.3711472585624438,1.6448358425290615,0.39479420497771822,-0.08163028671070624,1.5047340025684184,1.0820289490486201,1.2662685110362459,0.92734613124829302],"y":[3.9053087498333472,2.8634127342004518,3.3163229442136997,3.680244583789714,3.4381176082876359,4.0663463615097024,3.4877119628887336,3.5044558367004313,4.3032754363618304,3.4959175988503417,2.4888106168679318,3.4997216680619396,1.7914746078328883,3.3897992686545098,2.7714722047939104,2.8123821146159438,2.6389712794155766,3.5975760548160869,3.6140068775937046,3.8206283361653885,3.4553139982264414,2.6612144441907355,3.65354394982525,3.2264306464764174,4.0579292744369067,3.6985211273473007,3.0007549596045222,4.4590569021946385,2.9711612027463472,3.0925257776857848,3.6624541202829768,3.608243110295053,3.5605461873503863,3.9197884139034844,2.7560910553139872,2.8395156848353138,2.4382908365669862,3.2979539840514862,3.7322426590623752,2.8618373206124863,3.0505502934451632,3.5001497224164071,3.0770998994822838,2.5306921521555457,3.348159952765561,2.7520124734810767,3.6958638674984208,3.5801935140887964,3.8621872746648105,4.0968987121049434,3.3806168465578978,3.4060463688311757,3.2697463707090946,3.8760872967970612,2.1129151305680707,3.7208696823744893,3.0712638703475252,3.5566301060575967,3.4546683484976195,2.6446594881770564,3.4969284590764635,3.5092831884238755,3.3493826582607058,3.837578602822505,3.0942476629135087,3.7477231595457186,1.8719122071118743,3.8549376441202488,4.2517181232881098,4.1751639409533254,3.8042370501503666,2.8522104008121771,2.7506867757309847,2.9638281447686308,2.7892004876166507,4.1430632411747315,2.9332644953754117,3.6390468445511455,3.3505513705041872,3.397185423796786,3.4566396364069591,3.4672864636085845,3.3208004837387111,1.6783217181011985,1.7915753152971916,4.0248373272350033,3.1360848090872628,3.9777329282916547,3.2286449627893798,2.0215482348264309,3.241956018436742,3.2755536707373407,2.9455445691864219,2.0858201541252721,3.3333342262650452,3.9797215697308466,3.6378963529138182,3.6679217155010893,2.5864467915991609,2.5935757453292205,3.6965674408228337,3.1520046015901473,3.7947268525772371,3.756251235453409,1.8675952779274982,3.0188170858923336,3.7248898351990718,2.8405374170798532,3.9114514157991871,3.9973404228219662,2.1335852667396833,3.8499627084659127,3.2540846451302388,3.7540839284233098,3.7027779811436319,3.762056511954698,3.0844257549716803,4.2273251493449768,2.6466835832040343,4.2641748663274708,3.3710639999275394,3.022349873714802,2.4537758572855339,3.4445888478396407,3.1604952319281154,3.9161278867752829,4.0280694089249245,3.5903716447746752,3.349565057549694,3.6177070285180539,3.7697357130963844,3.3163228260853668,2.9084970430821406,3.9872704218724944,3.3840183358359601,3.4210899092407807,3.8110403986415005,3.6081400404052051,3.2936831771996196,2.874856186850872,3.1363075399637186,3.5356869450824293,3.651956207128674,2.7444568296471297,3.1944343115823965,3.3979011420622451,3.5505112605744369,3.5243651935951124],"z":[1.8503967073642427,1.8067155723188495,1.3817015351428974,2.1885384812013844,2.0213709011049659,0.91933085431374506,1.078622520940107,0.66382453623192306,0.32413405365643488,1.3791080386730064,0.24679862711438103,1.0443548619696879,1.1947643448705938,2.0217815983320819,1.1809016847057123,0.20345220020910731,2.6825489903548281,0.16455524244656813,1.5994941947546721,2.0034597245719348,1.7697663431023865,-0.095770763263336389,1.475424956647637,0.77442904669388801,1.3772689529895026,1.7588425075270353,1.8082441580931057,1.3842338963121967,2.2085637080647857,1.2768410056217989,1.344395709176412,1.2668712387912517,1.4283040285894584,1.0835145853162655,1.0551783376530919,2.0296649549367345,1.8295133083379214,1.1796438664882598,1.1608675774451032,1.441579490502318,2.591027190413508,1.9541543026657628,1.3715788277080507,1.1354358737053551,0.89750089128882704,0.73455097220960697,1.1269448985833526,1.0739695474186717,0.72498290008101818,1.0040222557440033,1.7501428235602152,1.8067036324222638,1.0040820919206437,1.5493387072899736,-0.092745769250425325,1.4742949209568503,1.9125904723133664,1.2156113833377835,1.9645488023621658,0.91436340411966932,2.3286778422690966,1.3321558304895036,2.4305201181146319,1.0769488971842525,2.1750142066142102,1.4951373606514902,1.4677625890954316,1.6570628071312026,1.1941071545077879,0.92928211415360629,1.4879172581632725,-0.19988704966157422,1.607159070938712,1.6264517497702089,0.38480432335496556,0.92733602326869491,0.21287823497009553,1.99600783239186,1.8516851611814293,1.4420736454113097,2.5942597903201419,1.3839090929588977,1.2731420716099988,0.44428143011823085,-0.39100176015276178,2.2187763512834922,1.3688383199325598,1.874716098058743,1.502863947370364,0.69257047499706437,2.0114853660938543,1.8858748489018549,1.9696706710176608,0.32541205004156359,2.3701295392175004,1.3624286551336353,0.62906340084803258,1.5517011430873338,2.0525243192867455,-0.90391696066238059,1.0999049639011973,1.0603772494770722,1.3333607442374038,1.9029639500173503,-0.072150593279738828,1.7766610935273854,2.004031221215985,0.87103359711749873,1.5547476732825798,1.1274785838261121,0.83640911201162527,1.919086517660098,0.34938104620540394,1.97922620011149,1.6772574504183373,1.0760945163191813,1.5756512390263133,1.2161617601739971,0.077757957127023325,0.68108420307724604,1.8935839375342354,0.87467843678834856,-0.018930911781039599,1.4123910038429588,1.5896416344106608,1.5754652153242092,0.44468531053404753,1.9515728318815491,1.421794786787818,1.4884542085138626,1.3482204168070977,0.21854995086034196,1.088938149447743,1.8145636110047458,2.5631649977932494,2.0008068176921348,0.82404542072487563,1.9706864654042413,2.0041653155933048,1.7152040308489043,1.8227976551822338,1.3290496887728418,1.5284339866894665,0.34308327534165128,1.6325878553163258,2.3553004616833171,1.2130817152399407,1.5733908773815843],"mode":"markers","marker":{"color":"rgba(102,194,165,1)","size":6,"line":{"color":"rgba(102,194,165,1)"}},"type":"scatter3d","name":"1","textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"frame":null},{"x":[-3.0151787966537538,-1.6104247753548626,-3.2333825090238237,-3.3727605984126834,-3.1163149256597698,-4.6929269209522584,-4.3550563941672067,-1.0027182637513747,-4.8288498835721283,-1.6175209074935923,-2.2847368907141443,-3.2338469312543827,-2.3884100818729936,-3.575572718576991,-1.9633271944617032,-3.7640507419256628,-4.5339577870696095,-1.6296724987876861,-1.2935417633252138,-2.4925788799697215,-1.6309079841864953,-4.9390280316632413,-1.7865400620196925,-2.7949946872070268,-3.002473018463955],"y":[4.9288470809685698,3.8014652103874971,5.0398419193327815,4.2531370683175318,4.653959767639277,5.9512413704461764,5.8633019385411309,3.3524744833985807,6.1637500367113045,3.1849616253774342,4.3392474858708745,4.5383449062150376,3.7942965245171734,5.9181559057161017,3.9931375380371525,5.6264105648974123,5.8063905481117333,4.1951634493253698,3.2564328746070519,4.4298177064967001,3.4503466764218311,5.4718074281996509,3.5549449156485724,4.4869037677246784,4.4483477199788108],"z":[0.22942036430580512,0.66147543108895224,-0.52556903759835827,-0.29639116859582648,0.77817505924378372,-1.0021601905050395,-0.22769103417063874,-0.055511850494870868,-0.099439438209736775,-0.07214934383940487,0.18767316385634797,-0.28113001388929892,0.53801789442283454,0.086494881653232825,-0.28020062179598049,-0.36098554823965645,-0.29144530762801463,0.81644460081523018,0.42302323095313088,-0.18294369358373797,-0.058366114657177726,-0.60256481092746039,0.54744866340574283,0.4919974834238503,-0.40478826701484827],"mode":"markers","marker":{"color":"rgba(252,141,98,1)","size":6,"line":{"color":"rgba(252,141,98,1)"}},"type":"scatter3d","name":"2","textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"frame":null},{"x":[1.7976196968228333,1.8646274675075727,1.5596202124463319,0.95184567490999039,1.970980556178231,1.6276219233284148,2.1021098663265825,1.7093836728706353,-0.011100210270273955,1.882761337954141,1.9067374171390143,1.6392233794725359,1.1839462079525243,1.9481549527067343,2.5576146239312867,0.96374416707251809,1.5662316445810502,1.0158801889299172,1.3022508328551894,1.2261693135786134,2.0474159885974981,2.0512987479268654,1.6248706541419726,1.867393986304942,1.1678948915447109,1.742494544019582,0.52602368007790457,1.7362160940353684,1.8425725976240663,1.9044609264276045,1.9215439623661481,1.5435234127454096,1.7495228722981691,1.9630690155699173,2.0591512885267917,1.3255731037774898,1.0223805059008322,1.4204794060171873,1.5303522880487239,1.1124997743066032,1.9571655436795239,1.4879442236286027,-0.014915305098194005,1.0821190918937367,1.3448955996047731,1.954622166515589,1.6317674313198736,1.8837298770200395,2.0860193378607192,1.7635820478674811,2.3323666091540889,0.80452716030407412,0.87955175946680297,1.0320489924112257,2.1538198918694791,1.2241645472893925,1.8089874383557667,1.0892823534558167,1.6244264852242145,1.5393707313263825,0.84573182751308262,2.6878225874402575,1.0728096527937336,2.1480901683764992,1.3290889529735828,0.95127330998726745,2.3080755151157835,1.4066917565286967,0.74444998069188095,1.2001447372571468,0.61213902352495475,1.6482420425035698,1.6132698816955799,0.85008303572925614,0.29131241216814713,1.6292306388992599,1.6597720280675659,1.8911116605019929,1.1824184189086906,1.342068195165627,1.4601600515033528,1.1778051505134721,1.2343164049075905,1.5819897287845928,1.4108636378038788,1.2682245899623905,1.9942168295033198,0.9570577672138596,1.4171421506881221,0.66925634410880863,0.92293343184400445,1.3991764836956413,0.92325470726308279,2.2208346064498339,1.4323034199491875,1.5649105805888761,1.6530984922016256,1.4307373565253121,1.033940331291916,1.2981802204153212,1.1567560983108029,1.9786635153146779,1.1182297636842384,1.7753784976146119,1.2741932637510149,0.99375171446991029,2.0129371224745669,1.7261452680814775,1.6632961334789116,2.5263386797019702,0.82041809995789938,2.0242763965550243,1.5702635794613524,1.1707900608541619,1.8445148466432633,2.2060811840793559,2.2200968091797995,1.1777760232018151,1.336839365274634,1.9639049900019661,1.5627854128655834,1.8323794838887273,1.8484521628604329,1.3381316047673097,1.7283115543286893,0.72314536804783058,1.099488978929591,1.5102055367983982,1.8275183858173714,1.3609483337532489,1.2225369623759454,1.3578849630394814,1.4604912738089986,1.3940253666606048,1.465805260237913,1.5422708885151586,-0.055275547695924319,1.4169876543554158,1.5644524267095101,1.3194465548212233,1.30805770874917,1.8954784895961889,1.6879978959197923,1.936772370361296,1.1935724710966715,0.91691776463846464,1.722789311109429,2.9165633939239211,1.7982164301613186,2.0133804174850973,1.6193962576049783,0.62375434707831845,0.12883032736934308,0.7064866658865594,1.4120610477388102,2.0480367434253539,1.8392047535985308,0.76584151628060548,1.6605311959503604,1.3038035977562024,0.89738603162058639,2.2575977797502134,1.2030503027342818,1.8803880592725097,1.1383321131015991,1.7044488145280248,0.90832951479523083,1.4526774550091446,0.62984357984746819,1.8007507355230707,1.3083308071192625,1.6562628649727138,1.3243293364158204,1.0918314522184835,1.6441689769525036,1.6371996524720844,1.9318152067423013,1.9913118764325237,1.471886315872323,1.7603122234652893,1.0320608262902919,1.3836786045665388,1.3722568822614172,1.6053295446424085,1.8970770777279418,1.556093129208445,1.5925315363381214,1.4281741789581794,1.2662291035244151,1.3591820615078707,1.4996794063937653,0.85952990754293912,1.9739636155656812,1.5522708855567491,1.6588626113730962,1.9405996580005238,2.1029486483807669,1.1981014460726296,1.4315458435353874],"y":[-0.86403452180553664,-1.3592582666323125,-0.5597179015889594,-1.0974993742144357,-0.81700145454456818,-2.1626405065530978,-1.7213028717551107,-2.235231416838964,-0.74887298267144009,-0.79517335770878161,-1.707454549472682,-1.6392193139928795,-2.2219710320019512,-2.439314498399777,-1.2000634144160127,-0.47530263204784806,-1.9899726072923234,-0.70438893853233298,-0.52265527840312243,-0.40435491400805318,-2.1932972503196719,-2.5684013330073303,-1.8764474627644017,-1.9216331715344332,-2.2853529011274123,-2.6101997714711285,-1.1950981006522929,-1.7492450676232054,-0.69858037791617145,-1.5403454954688436,-1.5319489275393745,-1.2029223086603005,-3.1543162097420971,-1.5223048236159993,-2.5270051360825287,-2.4503303346649985,-0.010891348276930807,-1.9065959853736252,-2.6557497661632223,-0.38460964500931427,-1.1821392599023477,-1.6746654731054649,0.097000072871569559,-2.2998484956083192,-1.956282157690596,-1.9494307154130661,-1.5872935553372369,-0.74521282107818232,-2.3382175999927406,-1.7153852928431557,-3.2501617571192569,-1.2163116784361396,-0.43141787197732623,-1.6520000425989974,-1.1809523835017666,-0.39876132511976803,-2.1416527060268526,-2.0199340347281383,-1.6688546259994881,-1.7517749789066559,-1.0847933144597739,-2.7749429688184208,-1.658247859906202,-2.2400548721213687,-2.0117733016142139,-0.55571162846805877,-2.1320744789743795,-0.8802450300158553,-0.5395263015632783,-1.058630754127821,-0.99982458707618505,-1.0782018019185735,-0.61046201693994928,-1.5061106190220541,-0.25121702749106656,-1.7113435540439965,-1.3884962003211734,-0.67107197170249044,-0.84548932822786593,-1.3211237913679306,-2.4855970918794266,-1.7652719861463277,-1.5727615057387929,-0.89361428654648889,-0.79788503203444494,-1.449279777025031,-2.4988633261002398,-0.40384599425940049,-0.66763597354316639,-0.35493294098923334,-2.134559022179876,-0.60553409416465276,-1.9367150631449073,-2.0873712261087749,-0.73344398855524018,-1.2483303095132565,-1.0668446056236078,-2.0632535687480131,-0.80464137510345946,-2.6618055226090718,-2.2330709272880149,-2.462467023902474,-0.54631017371430413,-2.1253353761888616,-1.0920916386264694,-0.53213546017478985,-1.9871747432880731,-1.734259355284842,-2.6137331803927593,-2.4147598411118354,-1.3323755314401604,-1.8887670517126907,-1.5060785022485559,-0.60627279328063588,-1.1517032886116765,-1.830803385758428,-2.6218909447316987,-1.823890562110442,-0.55783376599438717,-2.3973737526799432,-1.0707377503679691,-3.1659773010459435,-1.923174531193008,-2.6402987001270408,-1.3731735703937664,-1.8532789057687247,-2.8098005986226768,-1.1398908858601882,-2.3476871267945407,-1.128792479703161,-0.96753062235889375,-2.1198676204007936,-2.6210682566580439,-0.32114098804909752,-1.722438936087993,-1.8934263372720128,-0.43706041036543714,-1.4775102009858176,-1.3547848124906774,-0.94925719621628124,-1.4685220396685261,-2.3449576666667582,-1.3697630085109846,-2.3398746496704033,-0.79677318966134025,-1.7269187108574782,-0.72606117029645667,-2.9511767397698456,-1.9292771073567674,-2.7780776198040433,-2.1830612635490692,-1.4110370505513226,-0.34338343790329356,-0.58494233186574096,-1.1010411613097659,-1.0081647877459545,-2.265687617955344,-0.21525404966738532,-0.56036150199840185,-2.278254359269936,-1.5669304522825502,-2.7250007849916131,-0.97284723795401518,-2.3779660274962486,-1.4141382768793966,-3.1754447913657331,-2.0587354200243451,-1.4017813220710347,-2.4624810684539278,-0.78883539997479213,-0.83002360950989718,-1.8536504971102377,-0.37227539042322488,-1.1096570393909522,-0.57877681987929774,-2.0935985011373628,-3.1857002499843987,-1.3133426547702396,-1.8816648931049693,-0.97204504888698107,-0.61630512525586711,-1.9995687626286842,-0.73952047634714946,-2.1564824895583103,-0.97829043802369509,-1.9099319171604703,-2.3205864211236551,-1.1864901531024594,-1.9846424855670519,-1.4148585638313951,-1.402520280547271,-0.33904754338067178,-2.2872355291919453,-1.9123969658413462,-2.2267050469698431,-1.3831850970415931,-2.4975766557672872,-0.56744922961220812,-1.5930188275425687],"z":[-1.8662499550564471,-1.678103448620891,-1.4332412111219281,-1.7889420087092434,-1.3242344646379325,-0.68072608392396861,-0.74805095173881342,-0.98267560125736375,-1.526498923532098,-0.62609478518909545,-1.0526144511194337,-1.5197425385519072,-0.054609088235344327,0.0609819441219372,-1.4431181947344445,-1.3704026720326161,-0.65630469693474591,-2.234368731257478,-2.0376411778280228,-1.5073789357802969,-0.76360891155754929,-1.3369810205447019,-1.1836028206311464,-0.88293993878087718,-1.1754920293550157,-1.0109878891965476,-1.7612172616610415,-1.7118097870544453,-1.1836158561684837,-1.1301705447606176,-1.2363515525548683,-1.2739656459001707,-0.96832903599118136,-0.7315692738288595,-1.4473523420654271,-0.5505100045590251,-1.2975283603085899,-0.8286565007445329,-0.34511073435978662,-1.494930587384605,-1.231721669596376,-1.3226133009687926,-1.9500206812026788,-1.043944546426274,-0.52282023997038296,-1.4656892491683371,-0.45865105624973967,-1.9169873426305002,-1.1500962050190771,-0.45979712156146191,-0.32119766258228555,-1.3806664188288438,-1.5743965623351202,-1.0194861081111488,-1.2379645403564774,-0.86633055645860346,-1.2457710076219977,-0.57307372009962998,-1.901687651028124,-0.23274797474037118,-1.5654955984441896,-0.69193627889728571,-1.0660464196973327,-0.71566185860132792,-1.0437146737073848,-1.6622618056249654,-0.86837304883233757,-1.3012020039079744,-2.0634521559502694,-1.6932553785655211,-1.1376224224823339,-1.6002576820414132,-1.8899275931257784,-0.45398888547794536,-1.2921375550731355,-1.0639779474713666,-1.3010776730972871,-1.1832053355375445,-1.8823775910673859,-1.108831053339383,-0.83133743608774568,-0.44959376331632483,-2.4334906648444674,-1.9133945120522051,-1.6002657529162563,-1.1600217642783657,-1.2767380808216129,-1.2247490855783065,-1.9244286556302701,-0.9175318371134239,0.48124727912471477,-1.9130835282351561,-0.80793550589796947,-0.71996595616387049,-1.5195942990282483,-1.1975965826753354,-2.1950335044515081,-1.3075451594457419,-1.5228752445779807,-1.1565433688822977,-0.52160479317550879,-1.1083023234703886,-2.1473462534562415,-0.52941646009145094,-1.2315764945531138,-2.2038939651742071,-0.90349190036726656,-0.77129297773148608,-0.30074097389140564,-0.57782597839857752,-1.098165823431642,-1.512493735997374,-1.8538273810864767,-0.75359752265417357,-1.295945752373338,-0.94585155129142795,-0.31591032845753647,-1.1426373704809636,-0.99846431632463384,-0.5042621773711522,-1.8425335396875462,-0.31014496388403801,-1.6170148444356411,-0.72010795704633856,-0.77200429304717755,-0.88086735183512765,-0.7497471743381543,-1.7581870364330439,-0.79722909038387779,-1.7445996101842469,-1.5792970205654546,-1.2380723935121682,-0.85965974699145564,-2.0626577969470477,-1.130136749524441,-1.1654134391204927,-1.7084027597390956,-0.23462522639139224,-0.53232460697933015,-1.6808959000706785,-2.0984221699167063,-0.98881478155309421,-1.5587230290045322,-0.29150512296277503,-1.849551864952433,-0.94834262420398197,-1.449541963564341,-0.68350619957057646,-1.097041491089666,-0.18332561869943578,-0.79690033523345483,-0.83426253997745492,-2.1911500438962386,-0.8014606425963372,-1.3948791126675377,-0.87679140096936237,0.33980383216321303,-1.6162707102963969,-1.0321463174089249,-0.27311837043502946,-0.87024850733599568,-0.82105225984310326,-0.86440794844916491,-1.0804029978164034,-2.3553984212134016,-0.51161079469125537,-0.53718793425446609,-2.0015754176691987,-0.59650825184245559,-1.2167554438480277,-1.7505206602522094,-1.6153294045773494,-1.44614066558365,-1.6843323485080608,-1.6929376961304083,-0.41828314795576527,-0.46058006748258606,-1.3472622787500375,-1.075949798854102,-1.7513555114434152,-1.3126113261742589,-0.51043521039605899,-2.2769447310902988,-0.33081934442884464,-1.6593776948321062,-1.4744857290624249,-0.95706934496921403,-1.6167882579386066,-1.4101976599392836,-1.7431979022607484,-1.7710525290425463,-1.7583398884693193,-0.93343380961978217,-1.1774199154620408,-1.1157491767650929,-0.76736632123300563,-0.49545130969463558,-1.5081743620177275,-0.78113419891506963],"mode":"markers","marker":{"color":"rgba(141,160,203,1)","size":6,"line":{"color":"rgba(141,160,203,1)"}},"type":"scatter3d","name":"3","textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"frame":null},{"x":[-2.876481778857066,-2.2408328501759178,-3.417302013608416,-2.2047292210461156,-4.1034032623268288,-4.3359957878089546,-3.1285463425829008,-4.7169407313494567,-3.2976997578929819,-2.9779851170200629,-3.6682476185944783,-3.8298931393239184,-3.2472083698143197,-3.2547809510564591,-3.9954600632714952,-3.8532962362518526,-5.0508252873630344,-2.8066064091894347,-3.1023398726535243,-3.5986281513931151,-2.5023260669548169,-3.5890297657892862,-4.7265534452932698,-3.0688242446044476,-3.3152434093992866,-2.9312913324119956,-2.0464354870727131,-3.7075999403551014,-3.3138903567373235,-4.1361744313742497,-2.3351155493648119,-3.9704014180096059,-4.2470214772235702,-4.3552075118263316,-3.6531968677969804,-4.9214334404017004,-3.2980040393686698,-3.3837201970401378,-3.4784568838834842,-4.665783917346646,-3.9432345958461408,-4.3265058298358063,-4.2539579328757418,-3.3607987178097853,-2.6478338207976777,-3.0535675690724862,-2.7389947407630446,-4.1146072274808807,-3.4797771734121241,-3.8359180355082523,-2.5246427314295121,-2.4145713368298538,-3.5017579683746605,-3.4087320077543559,-3.5009711961081047,-3.1323461101310244,-2.3678079281652522,-3.0872984937960699,-2.3065482601940435,-4.5321659888949135,-2.1657344224561106,-3.2420980861570063,-3.1474629963031329,-4.410896721344713,-2.256123451977996,-4.6554021072858429,-2.1968099118804219,-3.199950312777037,-1.7467442496468257,-1.9233690459203596,-2.0395960301000167,-4.0530049986784178,-3.6859674947968504,-3.388887203043494,-3.123119035333465,-3.3516083816420625,-3.1664071534313205,-3.2857210764400713,-3.600279284951649,-1.2121629424684719,-4.7225949907655673,-3.9860918770540343,-3.1672946374215956,-3.8946011236247804,-3.1062291457713456,-3.2301994072081008,-3.2602547271607518,-3.1116652283017872,-4.5176199778249009,-3.9328931906040112,-3.3051862881246823,-4.9119351175342292,-3.8317555310257525,-3.3224817992869102,-3.023863948501873,-2.896488441603839,-5.3408631127876429,-3.5582858579247691,-2.7857718279380435,-2.1904392702535085,-2.731516862575472,-4.0076939449931581,-4.4764792518612371,-4.1298554900546902,-1.7843493057725328,-4.1011028653666157,-2.3265152489944869,-2.8592472897826462,-4.003841032473419,-4.1200657507236036,-3.1472193260692363,-4.1259152950366893,-4.5797016660868248,-3.0843762807763433,-3.1426084627455118,-4.0409666801875437,-2.9253055596005235,-4.4762515873494086,-3.7213469688490601,-3.4336109934774206,-2.4452714006235681,-2.3324975181534024,-2.5585168145765587,-2.6781697385657419,-3.0062868712569051,-3.2734899138392057,-3.5105442282505743,-3.4781552260162956,-4.3739938461520165,-1.737671944708415,-3.8528935189985796,-2.987509127377932,-3.3377661411336419,-3.7601457421740059,-5.2621235978263909,-3.093303052264003,-3.9628049325440915,-2.9748408107393653,-2.7025501197761428,-3.4531443860800124,-4.0738933074219288,-3.1155232872306988,-3.993770727663625,-3.2881473198971785,-3.8079531147615748,-2.7457787622240537,-4.450594379508618,-3.0998950368803304,-3.0497910538371844,-3.1878656957896019,-2.6341234194182808,-4.4578390450852856,-4.0322994846083642,-2.9858669397132749,-4.6624006879611839,-2.2124503859473399,-1.894553655910022,-4.149088689953512,-3.1420934816244714,-4.5984001146663278,-3.7296043833377568,-3.6856941026844368,-4.1345025759490204,-3.7320650056003699,-3.5190339500361847,-3.9430526387377003,-4.4831019295139001,-3.4641998550135331,-3.5725503881069356,-4.3602152038978206,-3.1668330752655578,-4.6879507628185575,-3.8961416993918871,-3.5758243276227164,-3.1778750017959956,-1.9317778511190058,-4.5204391510829609,-1.4818709279419482,-2.451617096487857,-3.3225103700719592,-3.6010414283338719,-3.5708293311568156,-4.061958315366045,-2.5464066108100227,-3.3545754103275063,-4.0464990232917142,-3.9641452234009735,-3.9470354699259214,-3.0218392578300861,-4.3329948793556792,-3.8033370516112917,-1.8039232053175347,-3.3147806200883236,-2.899004866725877,-2.3549960665905232,-5.2128457227343636,-4.2429186203432048,-2.9013185752485193,-4.2110826631851275,-3.0351579346037685],"y":[-1.368805708908382,-0.46427090209459987,-3.002634630536984,-0.21337112205955652,-2.2235999156513637,-2.506971277184161,-2.9206558786147134,-1.9175899271801184,-1.256704321719246,-1.6699333827925082,1.0105463019016829,-1.2606463663721275,-2.5445589530283814,-1.5904952912448598,-2.8210436872192908,-1.2115856263309115,-0.93921109532653402,-3.7848222553254951,-2.883551594918023,0.12411609174055788,-2.8573153722992273,0.55954647363988919,-2.638857207766617,-3.0321811201186852,-3.3178558657417412,-2.9348507686525611,-3.4649153048848662,-1.3692042060557112,-2.0357290844725671,-2.791419427657658,0.72990679158658178,-1.2497617456504961,-2.3304940518583295,-1.7976474833805236,-2.3656258807129218,-2.1610868495733286,-2.871053359884133,-1.9392876870551774,-3.1354834863157923,-2.6525859105411604,-2.1534965866418649,-2.8274167679258571,-2.4854227573803525,-1.8185366114426882,-2.9046628699135817,-2.6704549794841648,0.79772700659557794,-1.4937097903079442,-1.9322840176948997,-1.8753962612824964,-1.9465690115477825,-3.451086356654085,-2.5112076331748079,-2.5344900240850525,-1.4682655236827484,-3.3850993562220757,-3.3470653042919314,-2.4328962283259674,0.72767703457724853,-0.74101205553171057,-2.524644909778921,-2.6742446719677746,1.1865105746203111,-2.3728052706412326,-2.1771285291873133,-1.8138307155548037,-2.3249463919177984,-2.7325031995881055,-3.4214890091909784,-3.5606728328298902,0.94664305227620738,-2.4557632096259319,-1.3721623258901865,-2.7840273255673624,-1.4626506578801337,-2.3337162260024882,-2.7339214215282617,0.0011683585635303972,-1.7360404715540436,-0.67044846212639819,-1.1668439382129279,-1.8363343051895422,-2.2144732976428516,-2.0652627383024278,-1.2092601034095098,-2.0327256135408649,-2.4937056711411754,-3.4840002859262915,-1.1790157671768542,-1.0107751460678605,-1.1997613612869062,-0.71740517405818005,-2.0646808524968612,-3.3085330205605112,-1.5505766264406442,-3.4645246717869549,-0.21820535207729225,-2.9170259210718665,-3.2464654042622594,-3.1011087717289914,1.1298733834696386,-1.5412017026798865,-1.2114734002789895,-2.4762855714057763,-3.5094264764338683,-2.6635226112484776,-3.5521450130881451,-2.7026677514562527,-1.7849752840106183,-2.2470263869998797,-1.4996873369358616,-1.589386271373318,-0.53522454804832587,-2.7920408461877555,-3.5681393421448488,-1.19785149771795,-2.0285183542256857,-1.5124694759236581,-1.6753565245716784,-2.8402664729458298,1.1983845893606055,-3.3047745345591362,-2.8518991244721716,-2.5490526750623528,-1.68548437270656,-1.9303041505132528,-2.9877088240059839,-2.0851160322278655,-0.78259487294644525,-3.3658473688409778,-1.5226751997109442,-2.0418337234698227,-3.2858406470327823,-2.3368397002188277,-0.69834609433310169,-0.52349037412140775,1.5644542367430532,-1.7169794314158198,-2.8596469994491587,-2.0385486995754811,-0.85879211066072147,-1.8844143760521477,-0.94248850673445017,-2.616689103839704,-1.716417978468483,-1.8721741102903939,-0.55192551108789167,-1.7987097849033542,-2.3477954830471379,-1.8704127913763802,-2.3889990105898775,-1.5645683413946656,-2.270181723776846,-2.7621225214544523,-2.170498343218541,-2.0296696072372327,0.976479163997786,-2.0182293182208335,-3.248034245144432,-0.74621150629263866,-1.3428065796747826,-1.383918645484417,-2.5560330144429759,-0.97880289647109509,-1.832043774148149,-2.4205270318092276,-0.36056899402566311,-1.5524498958446296,0.98964759916942435,-2.0623720462340143,-1.6262883833186375,-2.764759789196777,-2.6938824774446242,-2.2671440073258431,-2.9490075119603176,-2.6604326332109975,-1.1116363854621669,-0.71858891728728524,-2.4472936515230153,-3.13001787079319,-1.3047700230643384,-1.9686518633497809,-2.6262383291812688,-2.7674520300346188,-2.7278608884881126,-2.2176753857050349,-1.0395276635582429,-0.98572828375758081,-2.7358693922925834,-1.1807500923626268,-2.7521592270994972,-0.62062682311695794,-1.6336811402133131,-2.7860713459597197,-3.4743428171628223,-1.9076690621051149,-2.0989663562223329,-3.4489780631183642,-2.6514353733664042,-3.3348459094624641],"z":[-0.33299942192410836,4.2574438002558423,1.0466725890326156,3.7958153751444947,0.659620696738487,1.2980967023975896,1.3240675663988255,1.3451418291899575,0.64893213162711483,0.14754165439032632,4.4818551329972722,0.67107569309140991,1.1806639930699796,0.42035146632663645,1.3041554658174697,1.1481177407398837,1.7710414149337341,2.9290923420865562,1.4210136213837719,5.1475126914056402,0.23892529933645684,4.6305166229240999,1.5946695811893072,1.7683095717511002,2.4450185871236063,1.5700838046219114,1.2727939929245342,0.40373514276184302,0.75310401999338905,1.6465320789393845,4.0305637592762418,-0.20194741276964931,1.809700144055137,1.4073981578413264,1.3015153404394075,1.4594450246323576,1.4342965580788842,1.117515268714979,2.3319423815641835,2.2727144834931248,1.373466355075585,1.5648206032826457,2.6671711478066533,-0.055064831090537614,1.4122160751763921,0.80742826299895265,4.570619018965008,1.2519222966032677,1.1490762807485486,0.80536257797900468,0.47105950130121715,1.3264307961055162,1.9932308683424422,1.4452113454441913,-0.27036444673117799,1.6630887103226979,0.44907170678799135,1.3705131018057537,3.0686779394514936,0.90042420531634415,-0.10271333137311851,0.2968148103852809,3.5936785185312328,2.0560225337601903,0.8379021052460377,1.9741269825298828,1.1562815856639663,1.056936212897901,1.0560868577977793,0.39338763541861355,3.3301751584070067,1.6303110987339149,0.31856399633163085,1.5938809689829945,0.23782186471384509,1.5137691944408016,0.6014102711251047,4.5716597169669972,2.1464697445700311,3.9307602740197134,1.3426060691635913,1.1859028005444936,0.37545796743252924,0.8283653334795269,0.09396682921765169,1.1132471344215398,0.16241905724501476,2.1671632661527926,0.67169153377545632,0.71213893446602961,0.38003596914774307,1.4165975708434548,1.146077306895291,2.3958144718238636,-0.037895264500454343,1.9323322980422168,0.28308223510975161,1.7323858137680177,1.8528793268178771,0.67866898282034582,3.5733904331738335,1.0105577489685742,1.3994156067669639,1.8901241223144387,0.9255407271143985,1.7689249499310908,1.5018463231364396,1.0886717840885032,1.4130841005508605,0.744685212556223,-0.51889241199730629,1.9286435808937346,1.0369698416482289,0.78003954131198838,2.0577614671060549,0.26334291364534146,0.15127514723121133,1.0739101479653501,2.0360255810931109,0.53088865104526772,3.7560793992262189,0.86417358235960984,0.86521181704165429,1.6096647451550983,0.79327749081158494,1.2594439253692082,2.05782083297674,1.3690167401679296,0.58534026771681924,0.3377369993250447,0.90169300737630365,1.7559995232653631,2.900603250521899,1.9622365567729694,1.3361757128584215,5.1144484812494309,2.9580863746116539,0.015020800562436619,1.5813189154326353,1.1911860800544818,0.23981825912587876,0.094430045505761576,1.1609046210542824,1.9097231852777745,0.5817729011098064,0.89488727212746522,-0.084591990462064198,0.45987495196867095,1.6105018476088302,0.73624278972164203,1.7391756039957365,0.7372878467234022,2.0851130572426757,0.9480691082657855,2.7167735167736691,0.53674622748245671,2.452945583627685,0.92586153837475227,1.5627006298687192,0.51558224350226767,0.3370532117391884,0.81334380150208296,2.353706476139259,0.4513045033666348,1.7102565277177082,1.7947545450631217,0.48770277383728466,-0.069362672135295844,4.8820480788855436,1.1054563577659411,0.804725417472128,2.2932848073860366,2.5392246607074656,1.6614119836452299,2.3738000525595697,1.7373593173096002,1.6888617392533525,4.3046752023408992,0.93647209198471715,2.2651314515513064,0.3403060385857905,1.4927673537793933,1.2407401762977019,0.10072587585349148,1.7191025274258438,1.5929139857858157,1.2406291890319125,0.67121477172360444,0.61765247476152685,0.29639664872820237,1.4208974646315584,4.0097977120472565,0.7836890602576092,2.0646997761332648,2.0761433703750236,1.7063915500980353,2.252574576872858,0.9789159417237252,2.4675499726425865,1.6785768796450782],"mode":"markers","marker":{"color":"rgba(231,138,195,1)","size":6,"line":{"color":"rgba(231,138,195,1)"}},"type":"scatter3d","name":"4","textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"line":{"color":"rgba(231,138,195,1)"},"frame":null},{"x":[-2.4777255738539496,-4.7824142002261931,-3.0514475513387929,-1.1157137352355257,-2.4209643082521053,-2.8072568919996597,-5.2205814811395381,-3.0740628973015998,-2.9164346424876748,-5.7243893951282221,-2.6552413959550503,-2.9188232548613517,-2.1328033980445995,-2.5428129682131688,-2.856550359051206,-2.172428310370957,-2.8735626724488297,-1.5703676463042031,-1.5194439138816993,-1.5694423908321025,-2.2164814768510226,-3.2281938980887341,-2.3083309681388138,-2.90019438759506,-2.2518997389126612,-4.2090748314291533,-2.6036179257400081,-2.9649110669691052,-3.7871501924849724,-1.113442525329726,-1.1858626761443107,-5.3256436508423972,-3.5964234124276273,-2.6456255779174844,-0.74302058842141583,-4.4726421467724515,-5.1853949816361586,-1.3213809840876991,-3.378467779066014,-4.6856094718966457,-1.871763643426767,-2.796719192830496,-1.9374916520917511,-2.4904580781808132,-2.9268514182271774,-1.0330206213492503,-2.6581484669592514,-2.9750994314384891,-2.5123888598884605,-2.9490213641011676,-4.8073732564530296,-2.040730698666922,-2.4208007679630397,-3.5354467150578461,-3.4881833546357264,-4.9479860974230707,-4.5757432397903202,-2.2848056253121349,-4.8750182390839498,-1.5744595820779765,-2.9110819457494332,-2.9889389056349431,-2.866809823314159,-1.1064154988726433,-2.3638859761234015,-3.8164233992758603,-3.2388745719764027,-4.5623022729951677,-3.1108629314475449,-2.9040150278401997,-4.2230086562441516,-2.9104477024930855,-1.8304389283503131,-1.3621716475064547,-2.3890173575750482,-2.8757146159853266,-1.1538814666457142,-3.6280932987951329,-1.8881062069329024,-3.3480063531016815,-2.6641980085845507,-3.0036101861844604,-3.0494131949703731,-4.8494446531571871,-2.525166860375144,-2.469922897746117,-4.752475561174176,-1.0070281070179685,-3.497578059141953,-1.4257859105517874,-1.8283019303872385,-3.1099921732695077,-2.1234517449277823,-4.3047467069079373,-5.4743933164165295,-2.2902345500001755,-4.3746148925310351,-2.5560679470820959,-3.8097613164675668,-1.5218639671928635,-3.1772144636688102,-3.107135814240451,-1.9634851645602485,-1.7660596738977776,-1.6893660007902749,-2.2312171405978729,-1.5315639694052208,-2.5560251473168374,-3.1624805341431346,-2.7941448270021998,-3.024114662291197,-2.8796302037620136,-0.65572165286791773,-2.5663543494731078,-1.3294842397843689,-2.3980955700345832,-6.378686897670681,-2.0508871218889535,-2.8829436988163861,-3.996477985118688,-3.2929316671604116,-4.8173527800286422,-2.0610100319148188,-1.0403933443861577,-3.4153513109476972,-1.1166602735487148],"y":[0.78279799182682808,3.0735518597900713,1.0668781607424629,0.84651913613252749,1.7006692414507594,1.570337965544313,2.430455373582717,1.1631253254087655,1.8059785690173138,3.0877525561402472,1.7798931948399033,1.8830245819566014,0.99980278835770731,1.5141029445208707,2.1469615358845577,0.99282348584628966,1.4628064779114411,1.1638409533140313,1.0072046397611154,0.96327429270603171,1.4660993998132339,2.0121269532361237,1.3305017313748448,1.6968905407960513,1.1105405274990556,2.3267950079554387,1.4017642536755031,1.1368995436501206,2.604806336092834,-0.1479810460462071,0.96475889203846288,2.7453107352066408,1.8937298006414962,1.7810984319084606,0.33618155764134233,2.5176099478252127,3.6886044705614931,0.55348380815412113,1.4609890262251741,2.8952414161151832,0.28502695027761865,1.9217407041901127,0.39678660734102489,1.2606282725596853,1.3645240557733649,-0.039227382313010192,1.2448526628483132,0.93163923590592224,0.62280230973423234,2.1195665711708092,3.0484885302709772,0.67236130246511094,1.0508186626113873,1.8832049560929935,2.0165694758036259,3.1112123442518507,2.8448732985909402,1.8648073868447443,0.25529167491807347,0.10727556563887403,1.5412400924690364,1.9645303117447366,1.4588213983491873,0.87856323203969444,1.8160144053893335,1.6526489855116959,1.8456775423715408,2.9917778782383553,1.6328322187929976,1.5915961647148673,2.7783195153341231,1.7102936557896624,1.0492175390075458,0.079402567669512369,1.1165380442258819,0.93445841551708198,0.51263781236647143,1.5334996602132873,0.96986365382234285,2.026349705226083,1.1025764368451962,1.4427490445620665,2.0756184539822762,2.6425207600648939,1.5054631275403381,1.4580544545336283,2.0354876452852215,0.55086052941760821,2.0349321100972597,0.9083734691048706,0.90542344334235891,1.1881368751550276,0.27346783133896208,2.2083933646156932,3.7114091745005355,1.3110216984348706,2.6420369558207795,1.2832134639324146,1.7266565794154858,0.64412279178048237,2.0857087500526932,1.410415704998762,1.0816058639247081,1.1407092203793456,0.47718094695800706,0.92720612709817107,0.95096526445260277,0.86240614250725822,1.2679221975181068,1.5551946889674393,1.1195807213166349,1.6006962110385563,0.2758419207640167,1.9504297493906566,1.280658272731906,0.57704286120918047,3.3480301016016201,1.2306272890698726,1.5326808149672617,-0.2914203393319994,1.6842769862271074,3.1918814787663949,1.1106316289877451,-0.086051311599901439,1.9200928872119885,0.43368157053450773],"z":[-2.5389136266069894,-3.7581288665386685,-3.0226667524333046,-1.9274981804687079,-2.3362630998892522,-1.7024856872877669,-2.7735226855700619,-3.0184623259639678,-2.1509607886276698,-2.698891102702655,-2.6270306588660932,-2.5179395035708372,-2.0106469830150231,-2.3881721031745178,-2.5375516483889236,-2.0909064670723563,-1.9909290550447034,-2.166373759243418,-2.4745360940869165,-2.4524482392752742,-2.039782747937688,-2.4099780899580541,-2.5895370893423579,-2.5837820267073246,-2.2815309273522666,-2.9984955781663243,-2.519534094315008,-2.1971330141117131,-1.9424946441592554,-1.7716621308517877,-2.1804534142962102,-2.8502584397157369,-1.9720644953396609,-2.398936306933781,-1.6864692502003356,-2.3667085803687282,-3.1638412558167377,-2.2115136502450756,-2.2712949018094282,-2.5450630767621574,-1.5600251734947643,-2.4303169545707779,-2.4615651277310464,-2.8277701702669056,-2.9558581216782289,-1.6884783031511927,-2.629581833837026,-2.2247244286396008,-1.9096047910754588,-2.618130666736497,-2.9080414891932707,-2.2106642476988587,-2.373912204013799,-2.5744667407739876,-2.9346634956142186,-2.175478884472323,-2.5727216631013206,-2.2954206923743659,-6.0565721275033315,-2.6484113715365329,-2.5215582191679444,-2.5728265543162081,-2.3929337163079025,-2.2549181907068205,-2.0933950939550932,-2.8248199947336126,-2.2052118511426042,-2.4654281500095929,-2.2454941940897561,-2.2838337395971697,-2.5192810393154343,-2.8685559484413163,-2.0666422522070511,-2.0070350811753057,-2.7389805530081754,-3.1705264079189264,-2.2171837877659972,-2.621401342827189,-2.0460080513192489,-2.8815289791201542,-2.609213819236277,-3.0039474098408023,-2.1933675987603842,-3.5046670536329381,-2.0709005380004544,-2.294158407807275,-3.4545681869035123,-1.9543697415121437,-2.4781575257736157,-1.5556198062806554,-2.4959898833951253,-2.7476905003463852,-2.2555113945802829,-2.9187785041999543,-3.0422379282368519,-2.34228254016279,-3.1040998146238903,-2.0692831451227383,-2.275809678077827,-1.4741809461028808,-2.4598881858997634,-2.5918011721607668,-2.2008003313307354,-1.8845788964830046,-2.1159612760704656,-2.4722467934540822,-2.4710313231042527,-2.6728437150343076,-2.9526522374702138,-2.5517095616475411,-2.5796424522671466,-2.4519184140649974,-1.4776946500098063,-2.5682070822834207,-2.0211086398567715,-2.6360195550023984,-3.4103042156262999,-1.9498662579932748,-2.1107553449670515,-5.7309238344991078,-1.5914843637088718,-2.3942591302598721,-2.2721319953109202,-1.9354455436722351,-2.01439006593285,-2.124051273088531],"mode":"markers","marker":{"color":"rgba(166,216,84,1)","size":6,"line":{"color":"rgba(166,216,84,1)"}},"type":"scatter3d","name":"5","textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"line":{"color":"rgba(166,216,84,1)"},"frame":null},{"x":[2.4846124067877589,2.4195658548961121,1.7499136979486656,2.8574694827257727,1.7086196242365876,2.3535725980886575,2.9589099299902482,2.1067809775836785,1.928372669904902,2.483703500648772,1.3528786426820223,2.4836837593637182,2.1923003660501839,1.901732951333778,3.4699276533487771,2.8718511940599418,1.7385224650466888,2.3140013094815997,2.605299306171847,2.7210665784059116,2.4315619546610669,2.2699827355123787,2.2024974546257936,2.0843368659747745,1.8608667669369356,2.0009060094862896,1.6633478821798005,2.2037786551508201,2.204625672149866,2.0602025344302777,2.4394708627191357,1.8754465309281494,2.7471841890816462,1.6243988783393881,2.8399880885560762,2.5688522356467227,2.824600177319855,2.4373605329860339,2.3858279905661957,2.5281777991930068,2.4685075413024653,1.5682370072363783,2.2241353464170688,2.3092874700286528,2.7988086527987046,2.5270177245562415,2.9653621360097824,1.6760026892734241,2.9207981978145816,2.9522724253146038,2.6293341353983291,2.7663133347220898,2.3284002582186307,2.7383807416346491,1.939896804226366,3.0490769136507034,2.9456615093421417,2.344415093499328,2.5513770500689961,1.2929010268463363,1.6453246748629118,1.9567345742033007,2.3060595267702051,2.5440530506281318,2.0742804273529645,1.0351402425077154,2.6917688014509724,3.2351689277306726,1.4086915246277665,1.9066561844439782,2.7962316249632577,2.5027559379461137,2.6091929224063759,2.1745904345799483,2.4451331314708127,2.7805602172082726,1.7670144305579123,2.646953582928786,2.3198833785450641,2.2585484450005384,2.2114472055847063,1.7687192366105466,1.1516096470194137,3.3868563462509891,2.2480628073926825,2.4994121136434404,1.7975529558729821,1.7475490225584633,1.5601792680549744,1.5617738176559501,2.3088304245196736,1.5128040465057055,1.5613707992872243,1.9051831303865527,2.5158113518266352,1.9278629044958924,1.967149829132588,2.9264512649051655,1.5582383163960336,2.1791806471781525,2.5230383044117293,2.7906056761635041,2.1577252363309305,1.5627729044633059,2.5172025216951139,2.8368055613434922,1.7892684882704106,2.0786046297059255,3.0424004331287926,2.4571108009057365,2.1441170355022381,2.4778438424115108,2.5616640249597284,2.8243603705866889,2.1139905116678452,2.1373778118762465,2.2303217227988021,1.9696562953278245,2.4558816065845206,2.8029055332056823,2.1922840091593838,1.9167574684099313,1.3839409157786828,1.0674550011489849,2.3924049474789926,2.1101216093844521,2.5746250588870603,3.0069946384691284,2.7133378216900135,2.6699260861536724,2.6382020105048598,2.6334200811347985,2.093334862625114,3.0043918000648127,2.0604806414950518,1.6491742241881957,2.4986568884121385,2.6710561936416064,2.8427599765995368,2.5162906058525305,2.3302378457160886,1.7389049882945675,2.6880395164595559,1.2148118172788829,1.5355476829515777,1.7506448475493013,1.7389440675662329,2.5170136384926685,2.2970980301353285,2.2760827225479376,1.0943674321537462,2.2149254035882215,2.6412186046232069,2.4380234561118228,2.1564031473011176,2.0301627677443004,1.738605772905502,1.7825158172533684,1.2498586918180776,2.7526330194291355,1.5733971747040889,1.5244577069163181,2.2247196357325509,2.3906621290133891,2.3387843461473103,2.3825085528727028,2.0127966291037565,2.1189894645865652,2.4596394921977183,1.5506551503614117,2.0737832462202297,2.3579258467472659,1.5036516242233049,2.9748127500564712,2.6183346689729925,2.2790529241226043,2.8414079427415579,2.4420713911499252,2.4281892110894208,3.4314734258051369,2.3681020151423122,2.5580486703882648,1.9797719405664636,2.0695621983487826,1.8028234775752614,2.2172116396802246,1.7965867630839762,1.5286140632769842,2.9279957141997262,2.7915268770058903,2.2796917353549602,1.6723761286407137,3.2657472844876723,2.4109022046433513,2.6638291709469035,1.9861132139036111,2.140997313829736,2.6257778113105417,2.3606970490951324,3.2181770087621384,2.7925960981826607,3.1127532571711378,2.498375967988435,2.0447432266997803,2.8806615401921336,2.0846380627004883,2.8514114971310258,2.8349637732834383,2.3024293430216973,2.3822465550785088,1.6554189184624175,1.5328767698436616,2.4059090978072368,2.5972755524510402,0.96176377121057921,2.9354910840541515,2.2511944240243142,2.5757400560509116,1.9949574902197564,2.5307775425496311,2.021148238690357,2.2951982121079908,2.7550209787841826,3.343325130690483,2.5578738060967101,2.2482199992007823,2.3052141738752834,2.5021197595935059,2.8317178633304598,1.1021505837982302,2.6223995891528018,2.1856498501591908,1.3155495233638574,1.8811183653679207,1.357103261598309,2.2004216550080771,1.8360870484449061,2.691356934253256,2.243975012840306,2.5784252904963862,1.7145938729857231,0.40001125526291492,1.7573899760876437,2.1740187433390954,2.0122721077766288,1.5904208089711074,2.7356642982869359,2.2489669561437307,2.48352408026255,2.6505217668656571,2.3094250776926613,2.517947660160575,2.9457916116112477,2.2996886763867206,2.5518930118513712,2.4960233491543815,3.1727795967140886,2.9503029916304966,2.7265215268772138,2.072067031972606,2.5242942583642227,2.9226302830444943,2.8696311195495219,2.398173572099469,2.345701100028927,1.7551061566228003,2.6237087352973232,2.4231287059581366,2.195157132144459,1.4058612790837484,2.4611089940673283,1.9910229992634083,2.0017769586095775,2.196622504106378,1.974857310735866,3.069723085544624,1.8914214225195671,1.7420509186523994,3.1450054356127559,1.98529999653252,1.3867639092673711,2.5336365830804763,2.2623764663979267,1.1179553606209021,2.1903335500293242,2.416482730512223,2.6166693831009225,2.4681133082874247,2.8344497134555846,2.9828720733716247,2.9875171692782017,2.7801802304526051,3.2019632660983217,2.0761368694629501,2.8121629827070787,2.1385506865713642,1.6347919971337572,2.4547191398171608,1.9027707222375638,1.7569822166472742,3.0596692334679605,1.1734224713592833],"y":[-2.0915921590671731,-0.1697574336182599,-0.038134260391355264,-0.75733931763299323,0.096864523018801205,-0.053472323402231348,1.4228205929951945,-0.82273105994358042,-1.3382636405662109,-1.4230903777521446,0.48958345383718616,-1.5328891293058517,-0.11509913625136271,-1.3303458610799594,-0.025595363673423355,0.029399727947355542,-0.60796592209883926,-1.6162718646323313,-0.91119069284603094,0.24149886361584086,1.0477209817717279,0.11118483143194455,-0.6526503298725399,-0.64085495703649153,-0.39404721066733894,-0.18029304556918524,-1.1637427336204578,0.052044095976539417,-1.2675571569458941,0.50681841783867121,-0.71676606058646741,-0.67689593397998327,0.29592403834323888,0.30474787884206,0.3507332467441524,-0.25888627697709488,0.5464887683496692,-0.56131677946817471,-0.070376354333206326,-1.292984392628354,-1.1828566212143523,0.8855913507875407,-0.31472514034394666,-1.1036127455535529,-0.9797675726725884,-1.3879788729645799,-1.3669213440978449,0.4632269261659957,0.041116841141687482,-0.15507805996485599,-1.264505817646389,-1.3063271130809915,-1.2785241829732448,-1.4449958491909867,-0.75577688158854306,-0.12002017277997964,-0.46338057389343629,-1.3089463878257821,-0.88169535027190082,0.2260506125001317,-0.12615824317273266,-0.61016931569194088,-1.646860081511959,-0.027246617275922952,0.092008669681394789,1.3889356186193473,-0.84787953201428268,0.85107043252481951,-0.083847344874020069,-1.0615172633243486,-0.43174705280804582,-1.4187406718202553,0.50267509783412401,-0.80571484821206063,-0.50970805670668817,0.19278243558732044,0.14711443279784187,-1.7592237690752748,0.038496890613077123,0.05410270136004329,-0.17748797300333338,-0.0066770564011632144,-0.36818997433976469,0.10224847298709283,-0.26063753570476927,-0.22740734339470342,0.55275636473824874,0.26706826107779991,-0.50040725399473085,0.5024654788495736,0.08088156413048958,-0.025055236636549436,0.79231666863258321,0.25678740278087536,-0.55876324718301651,0.73552258559259376,-0.67847962867794287,-0.098584092794574363,0.14909969000580775,-0.23563686810383519,1.791450486678609,-0.35891565211399101,-1.2676904241202764,1.0241513168648502,-1.2963304530921114,0.71488788589552799,-0.74632231043248975,0.076786504154584018,1.3652032841173571,-0.12604376699782152,0.10635980118052782,1.2477842225445799,1.4178231458363542,-1.6227607763050913,-1.3064303617481348,0.7528392109239519,0.58939302644425628,-0.22286099677725951,-1.4013646708789813,-0.83994193301426456,-0.85151445473265064,-0.001591473853873232,0.28852966234559485,-0.77253738352220669,-1.1649414444656334,0.058908749389057297,-0.5409428038066495,0.56695029531513652,0.019895748386251452,-0.66432776129043991,-0.016992653063704996,-0.21201199770159368,0.023507664656761573,-1.6103282381848374,1.1387853683088232,0.43892333116232884,-0.59008821342019624,-1.0527292952903904,-0.42708993102782522,0.91913603792950815,0.70731854037241204,-0.59256753385235117,1.2004004847556946,0.22732538804669827,-0.049475344923817416,-0.038380063208504511,-0.52917639527858806,-0.098534680180831821,-1.6304902089526672,0.49153577574322799,0.42461845422412087,-0.079129191837157692,0.6496568553318065,-0.44163151922627364,-1.1493972869644025,-0.23520001765198309,-0.53461367384095959,-0.8513971412869632,0.94666002025090601,-1.8345669126764956,0.04649506018933984,-0.034507692040538218,-0.0095257620895624617,-1.580225140368513,-0.51902847736358115,0.18557322578633648,1.4539332876367375,-1.0245249476740188,-1.4047324124591245,0.81893062270158079,-1.1260908565594554,-0.85885987538853603,0.037401578509374242,-1.2784222374030321,-0.66266240290013101,-0.15816624782930072,-1.6454012444434596,0.38544960953512464,-1.6698864661037403,-0.11415681583114198,-0.17566468730177359,-1.4464244876813923,-0.4083397089292623,-0.10889709569231298,0.2705175664468123,-1.1564390677469558,0.74062502616386572,0.41033206050043031,-1.6137430892511593,-0.2165976581082143,-0.96063193923556078,0.89407462867443688,0.14655988666928871,0.025847629863394034,-1.0155318253457253,0.45693944938424286,0.022028798450981796,-1.38400419340675,-0.6252796046328094,-1.5211785306789807,-0.45840645152245202,-0.32807987705122144,-0.72835319894129291,0.16356852853056586,0.31091726587865587,-1.3530900773549173,-1.4565470959026598,-1.574560718462241,-0.63874553030296966,-1.3646177125944601,0.012180679495020066,0.11079869100326716,0.36641709573753523,0.57012472917874302,-0.71581907046873361,0.53732493855692731,-1.0576769903625978,-0.98061737722894515,-0.33735448185085393,0.1538795946897687,-0.2965937027143879,-1.7058165214074994,-0.31535204804473727,-1.1981287219320955,-1.0288662911824857,0.1180905836857985,-0.97532133723964121,-1.3293774768075859,-0.16524406459420451,-0.077342611308598971,0.40727785254406645,-1.5419329413413081,1.114792117453379,0.020610595404211951,0.12013703297742918,-0.71343751602251626,-0.31850510137720184,1.3282710531837603,-0.54325316339110619,-1.0234153691251531,-0.90905650323630849,0.59177564574654196,-0.43038296627707984,-1.6113969098162206,0.80513719817706264,0.53824797709991157,-0.20384879703758194,1.3054794314864004,-0.13152905367729403,-1.3032254931952225,-0.76955714767761085,-1.9535425020350135,-1.1457548793816601,0.46017000229906735,-0.42467970685309686,-0.77036547711541414,-1.2646059392357558,-0.69357549323073608,-0.17196291261853386,-0.8507983740000884,-1.4128436368865869,-1.3267277816386582,0.47154616649015496,0.65071385025123352,-0.99526472731075266,0.89113815747359859,1.0969917466962209,-0.82377838460331843,-0.69020383856200451,0.83478610259815333,-1.892101367303765,-0.76198473567745717,-1.1163524352752547,-1.300609175974577,-0.74767659017121169,-1.5798585463198445,-0.64273172628373787,0.010023592377068083,-0.21714105836470865,-1.1374647414090435,-0.69123314742211417,-0.060268112904656959,-1.4614742128412892,0.44690054056844986,-0.042148131906234738,-0.87145632703233966,-1.7586058669748752,0.63408453968963252,-0.33236090437851329,-1.5350856071555621,-1.5500560297140755,0.45398531365192418,0.52801775128712358,-0.10010282819935351,-1.4480216645438713,0.69582306956796225,1.0821416372272377,-0.85762194187171115,0.42986216034640379,0.250448127095662,-0.16681193674877326,0.62893102962455871],"z":[0.68215641018886708,-0.45848233201229749,-0.16485539857959111,0.144613490553924,0.094476455415968399,-0.83972613354800196,0.82042397360873609,0.17493600065873871,0.57162742949990664,0.0055154268808431106,-0.54860048637772973,0.40978653496445483,0.066225919632846103,0.56190892155806416,1.50550360650754,-0.25003927727309683,0.55823400333670725,0.12662668439381805,1.0166196662174734,2.0539393022097845,1.1084367352361353,-0.078270147226020229,0.088564345168310243,0.050952757330435722,0.32318708489366293,0.26693483993655071,-0.15785604866700043,-0.13773264720540446,0.17101491107387976,0.028482815418715744,-0.0014061455148170407,0.72457491217932291,1.3463060062292602,-0.35115629218414224,1.4753669300999186,0.40036755841828781,1.2129688870496336,0.15186198154180874,-0.039519586328931773,0.086414551177687177,-0.069341010314468515,0.58732206849746893,-0.10775829740695198,0.64775759090694129,0.38546455648515549,-0.16203642639124752,0.48865648444266829,-0.899247378810764,1.5457291905806128,1.7118999394586085,0.91836600176840022,-0.21303539468788316,0.75070514440832314,-0.12633826946654614,-0.37998504569479202,-0.70972663400240421,1.4820394021570391,0.10179736907639231,0.49490772275229133,-0.89286413005311782,-0.23838217931061667,-0.29585407750369613,0.24020415254970012,0.081045842126119344,-0.13162977424704259,-0.83769693924131328,0.50133356499370196,1.1078575113433664,-0.86533034932275754,0.15947725120971828,-0.03712347075275016,0.82954529307619551,2.0300848417057513,0.28951670551329134,0.11020974625160619,-0.69485676606604141,-0.40998364307861607,0.41031748668149243,-0.74833195221943716,-0.1041764587554482,-0.57414751354702498,-1.1000987759232115,0.71351631855582942,1.8787238087818758,-0.48459255403943535,2.1630960164489315,-0.37645385933343373,-0.14164151839838207,0.17056853767864746,-0.59110447483407436,-0.52600890937806044,-0.45247071510144005,-0.21343093772242883,-0.0035207842158094804,0.46065076510244379,-0.44369207479935185,0.22088092336947548,1.2656519975926568,0.23659157923016699,-0.30078609005893175,0.56663889646717303,1.7218488010944148,0.4608689367871926,0.92668215083575445,0.79168151391807406,1.5718158398946409,-0.40217296962895471,-0.1118251564488532,1.2766985421280763,-1.0784743929119398,-0.46514310642103773,1.0531968332064294,0.19304055991217361,1.2747501929679255,0.83808549418185452,0.35048789634865751,-0.26969550588045055,0.10267902694515774,0.44565365661493916,-0.36990492205233261,-0.59663370020422624,0.21988586349747608,0.029191872572364157,1.5947142361333853,0.57237152312817563,-0.4995303901372653,-0.39347045184394669,1.7113757185394489,1.9038116138728436,0.053022656670982604,-0.33847597984237365,-0.83115328813527245,-1.0994301464454252,0.44357479488279961,-0.082873078123138794,0.12508157714378212,0.26887366568509385,0.011925331403257605,-0.095898641873836787,1.583466819326131,0.57120756062098077,0.29056988504318715,1.582617361654781,-0.28029379898447948,-0.32564878022174337,0.70970055842636826,-0.3460514935846381,-0.20490089804219805,0.68003459430384838,1.3195728455208404,-0.052119530879795796,0.13851791114020917,1.033546089247698,-0.044048550681335494,0.24350670325344467,-0.58045477705104942,0.53026963059410348,0.07520101901105275,0.28513311829680377,0.14694387335328185,-0.80049065400944175,-0.88220622858703357,0.78117440288197826,0.67245073729885874,-0.52864643862537597,-0.71645681413763951,0.3802034475532437,1.0927333745148866,0.27957882704276993,-0.72992658021891677,0.86238657858328949,0.026201649233338876,-0.88433792378984799,0.42781392232165411,-0.33756664982609996,-0.20837909353760065,0.853322364194262,0.41905528048770996,0.44496940396664891,1.9782993037261676,2.312912777753386,-0.060372683715562675,-0.89372248667539878,-1.1152097926013944,-0.17348272744952772,1.0167292825907441,-0.96420783187549131,-0.83393309388745152,0.50934558068313052,-0.43314542732067274,0.13995177807742953,-0.58987402710406156,2.1070575407965171,-1.0754975094233872,0.52609295381153676,0.16787428772338994,-0.14607120796062145,-0.093278119159782666,-0.072861743243758437,0.25041893242945207,-0.45669658697087373,-1.0246648625418948,0.52104419816425829,0.603209893674157,-0.3480176220398471,1.1187249131754329,0.36263797846688484,-0.011261915881135121,-0.15812709398134872,0.1817369150186901,0.20262014239011961,-0.083600120697525149,-1.4243549924048242,-0.11254371330458356,-0.093975736462002787,2.1847574239164405,0.47887670923999759,0.25543558127441379,-0.34753687654690457,-0.30642910625731329,-0.82779945475033223,0.88085899149162439,2.2107290163640303,0.71509530589007553,0.093166324134447281,-0.13257954772390085,0.48269215882681366,-0.068724261604928852,0.26017798090451522,-0.1295196243578276,-0.86179461247039368,0.35761551962260951,-0.57473840730228676,-0.59867282293621016,-0.15816741833204875,-0.22243515318193988,-0.23640358749771073,1.4746750296713556,-0.42625359789500827,-0.35134618629944792,-0.023975529855226524,0.17883978677870779,0.21718440354769553,0.081741510301164277,0.11621659469425491,-0.051439533463601583,0.18084853034345022,0.69078744676869352,1.9499448396428223,0.081322748594255534,0.12766942264824946,0.36277621185575482,0.041615640605342293,-0.31085189977151384,-0.24407663424432044,0.61969663407798903,0.13446872818560018,0.55158731071409128,-0.18107940981906284,1.1794969629095629,0.28423223744355242,-0.12735720864846017,1.9541173204985498,1.6444397043817873,0.4634891821029774,-0.67304929035951677,1.3357306238228188,-0.36289561065945142,-0.023449601184394736,-0.41226600759369442,0.39812936551647332,-0.17858477005075069,-0.24076542039138821,-0.19617838648871136,0.036269285576130024,0.42235640562379922,-0.34952717611113732,-0.84545838836587628,-1.161057247647405,0.6733372674695367,0.64676526031995973,-0.48061001859316976,0.32215345966988251,0.25060218655408956,-0.46918583904611505,-0.49902630568854517,0.14313281440114101,-0.62179422100736104,-0.27592132956707455,-0.18814528760894897,0.85519373183192371,-0.78194581970727317,1.2689347674518694,0.49128561446268776,0.16781479218974976,0.065059120124866657,-0.36658453422572002,-0.48947673930791236,0.097868342897582311,-0.70655537181994921,-0.98304896873879211,-1.0163952166488135],"mode":"markers","marker":{"color":"rgba(255,217,47,1)","size":6,"line":{"color":"rgba(255,217,47,1)"}},"type":"scatter3d","name":"6","textfont":{"color":"rgba(255,217,47,1)"},"error_y":{"color":"rgba(255,217,47,1)"},"error_x":{"color":"rgba(255,217,47,1)"},"line":{"color":"rgba(255,217,47,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="cluster-statistics-and-dissimilarity-calculation"
class="section level2">
<h2>Cluster Statistics and Dissimilarity Calculation</h2>
<p>A function named <code>compute_cluster_stats</code> was developed to
analyze the K-means clustering results based on the principal component
scores (<code>pc_scores_with_clusters</code>). This function utilizes
the <code>daisy</code> function from the <code>cluster</code> package to
compute dissimilarities within each cluster, focusing on the first three
principal components. The dissimilarity metrics include the maximum and
average dissimilarities within each cluster.</p>
<p>Additionally, the function calculates the isolation of each cluster,
which measures the minimum distance between each cluster’s centroid
(<code>cluster_centers</code>). This isolation metric provides insights
into how distinct each cluster is from others in the dataset.</p>
<p>The computed cluster statistics (<code>cluster_stats</code>) include
the number of observations in each cluster (<code>number_obs</code>),
maximum and average dissimilarities, and cluster isolation values. These
metrics are crucial for understanding the characteristics and separation
of clusters identified through K-means clustering applied to principal
component analysis.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="co"># Perform K-means clustering with K=6 using PCA results</span></span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a>kmeans_result <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(pc_scores[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">centers =</span> <span class="dv">6</span>, <span class="at">nstart =</span> <span class="dv">10</span>)</span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a><span class="co"># Add cluster labels to the PCA scores</span></span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a>pc_scores_with_clusters <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pc_scores, <span class="at">cluster =</span> kmeans_result<span class="sc">$</span>cluster)</span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a></span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a><span class="co"># Function to compute cluster statistics</span></span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a>compute_cluster_stats <span class="ot">&lt;-</span> <span class="cf">function</span>(cluster_data, cluster_centers) {</span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a>  cluster_stats <span class="ot">&lt;-</span> cluster_data <span class="sc">%&gt;%</span></span>
<span id="cb56-11"><a href="#cb56-11" tabindex="-1"></a>    <span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span></span>
<span id="cb56-12"><a href="#cb56-12" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb56-13"><a href="#cb56-13" tabindex="-1"></a>      <span class="at">number_obs =</span> <span class="fu">n</span>(),</span>
<span id="cb56-14"><a href="#cb56-14" tabindex="-1"></a>      <span class="at">max_dissimilarity =</span> <span class="fu">max</span>(<span class="fu">daisy</span>(cluster_data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])),</span>
<span id="cb56-15"><a href="#cb56-15" tabindex="-1"></a>      <span class="at">average_dissimilarity =</span> <span class="fu">mean</span>(<span class="fu">daisy</span>(cluster_data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]))</span>
<span id="cb56-16"><a href="#cb56-16" tabindex="-1"></a>    )</span>
<span id="cb56-17"><a href="#cb56-17" tabindex="-1"></a>  </span>
<span id="cb56-18"><a href="#cb56-18" tabindex="-1"></a>  isolation <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(cluster_centers), <span class="cf">function</span>(i) {</span>
<span id="cb56-19"><a href="#cb56-19" tabindex="-1"></a>    min_dist <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">dist</span>(<span class="fu">rbind</span>(cluster_centers[i, ], cluster_centers[<span class="sc">-</span>i, ])))</span>
<span id="cb56-20"><a href="#cb56-20" tabindex="-1"></a>    <span class="fu">return</span>(min_dist)</span>
<span id="cb56-21"><a href="#cb56-21" tabindex="-1"></a>  })</span>
<span id="cb56-22"><a href="#cb56-22" tabindex="-1"></a>  </span>
<span id="cb56-23"><a href="#cb56-23" tabindex="-1"></a>  cluster_stats<span class="sc">$</span>isolation <span class="ot">&lt;-</span> isolation</span>
<span id="cb56-24"><a href="#cb56-24" tabindex="-1"></a>  <span class="fu">return</span>(cluster_stats)</span>
<span id="cb56-25"><a href="#cb56-25" tabindex="-1"></a>}</span>
<span id="cb56-26"><a href="#cb56-26" tabindex="-1"></a></span>
<span id="cb56-27"><a href="#cb56-27" tabindex="-1"></a><span class="co"># Compute dissimilarities and cluster statistics</span></span>
<span id="cb56-28"><a href="#cb56-28" tabindex="-1"></a>dissimilarities <span class="ot">&lt;-</span> <span class="fu">daisy</span>(pc_scores_with_clusters[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb56-29"><a href="#cb56-29" tabindex="-1"></a>cluster_centers <span class="ot">&lt;-</span> kmeans_result<span class="sc">$</span>centers</span>
<span id="cb56-30"><a href="#cb56-30" tabindex="-1"></a>cluster_stats <span class="ot">&lt;-</span> <span class="fu">compute_cluster_stats</span>(pc_scores_with_clusters, cluster_centers)</span>
<span id="cb56-31"><a href="#cb56-31" tabindex="-1"></a></span>
<span id="cb56-32"><a href="#cb56-32" tabindex="-1"></a><span class="co"># Print the cluster statistics</span></span>
<span id="cb56-33"><a href="#cb56-33" tabindex="-1"></a><span class="fu">print</span>(cluster_stats)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 5
##   cluster number_obs max_dissimilarity average_dissimilarity isolation
##     &lt;int&gt;      &lt;int&gt;             &lt;dbl&gt;                 &lt;dbl&gt;     &lt;dbl&gt;
## 1       1        148              12.0                  4.57      1.97
## 2       2         25              12.0                  4.57      1.97
## 3       3        199              12.0                  4.57      1.97
## 4       4        200              12.0                  4.57      1.97
## 5       5        126              12.0                  4.57      1.97
## 6       6        302              12.0                  4.57      1.97</code></pre>
<p>The analysis revealed six distinct clusters, with cluster sizes
ranging from 25 to 302 observations. Despite varying sizes, all clusters
displayed consistent internal structure and isolation metrics. The
maximum dissimilarity within each cluster averaged 11.98, with an
average dissimilarity of 4.57. This uniformity suggests a balanced
separation between clusters, providing a foundation for targeted
strategies based on the identified clusters.</p>
</div>
</div>
<div id="evaluation-of-k-means-clustering" class="section level1">
<h1>Evaluation of K-means Clustering</h1>
<div id="silhouette-coefficient" class="section level2">
<h2>Silhouette Coefficient</h2>
<p>The silhouette coefficient, a metric used to assess the effectiveness
of clustering algorithms like K-means, was computed for the clusters
derived from principal component analysis (<code>pc_data</code>). The
<code>calculate_silhouette</code> function was employed to calculate
this coefficient, which quantifies how similar each data point is to its
own cluster compared to other clusters.</p>
<p>Upon computation, the silhouette coefficient
(<code>silhouette_coeff</code>) was printed to provide insight into the
clustering quality. This evaluation metric aids in determining the
optimal number of clusters by assessing the cohesion and separation of
data points within each cluster relative to others. Higher silhouette
coefficients indicate more distinct and well-separated clusters, thereby
validating the effectiveness of the clustering approach.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="co"># Calculate the Silhouette Coefficient</span></span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a>calculate_silhouette <span class="ot">&lt;-</span> <span class="cf">function</span>(data, clusters) {</span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a>  sil <span class="ot">&lt;-</span> <span class="fu">silhouette</span>(clusters, <span class="fu">dist</span>(data))</span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>  avg_silhouette <span class="ot">&lt;-</span> <span class="fu">mean</span>(sil[, <span class="dv">3</span>])</span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a>  <span class="fu">return</span>(avg_silhouette)</span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a>}</span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a><span class="co"># Perform PCA</span></span>
<span id="cb58-10"><a href="#cb58-10" tabindex="-1"></a>pc <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(data_final_scaled, <span class="at">center =</span> <span class="cn">FALSE</span>, <span class="at">scale =</span> <span class="cn">FALSE</span>)</span>
<span id="cb58-11"><a href="#cb58-11" tabindex="-1"></a>pc_data <span class="ot">&lt;-</span> pc<span class="sc">$</span>x[, <span class="dv">1</span>]  <span class="co"># Use first 4 principal components</span></span>
<span id="cb58-12"><a href="#cb58-12" tabindex="-1"></a></span>
<span id="cb58-13"><a href="#cb58-13" tabindex="-1"></a><span class="co"># Perform K-means clustering with K = 6</span></span>
<span id="cb58-14"><a href="#cb58-14" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># Set seed for reproducibility</span></span>
<span id="cb58-15"><a href="#cb58-15" tabindex="-1"></a>kmeans_result <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(pc_data, <span class="at">centers =</span> <span class="dv">6</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb58-16"><a href="#cb58-16" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> kmeans_result<span class="sc">$</span>cluster</span>
<span id="cb58-17"><a href="#cb58-17" tabindex="-1"></a></span>
<span id="cb58-18"><a href="#cb58-18" tabindex="-1"></a><span class="co"># Calculate evaluation metrics</span></span>
<span id="cb58-19"><a href="#cb58-19" tabindex="-1"></a>silhouette_coeff <span class="ot">&lt;-</span> <span class="fu">calculate_silhouette</span>(pc_data, clusters)</span>
<span id="cb58-20"><a href="#cb58-20" tabindex="-1"></a></span>
<span id="cb58-21"><a href="#cb58-21" tabindex="-1"></a></span>
<span id="cb58-22"><a href="#cb58-22" tabindex="-1"></a><span class="co"># Print evaluation metrics</span></span>
<span id="cb58-23"><a href="#cb58-23" tabindex="-1"></a></span>
<span id="cb58-24"><a href="#cb58-24" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Silhouette Coefficient:&quot;</span>, silhouette_coeff, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Silhouette Coefficient: 0.6351648</code></pre>
<p>The Silhouette Coefficient for the k-means clustering algorithm is
0.6351648. This coefficient measures the quality of the clustering, with
values closer to 1 indicating dense, well-separated clusters. A value
near 0 suggests overlapping clusters, and negative values indicate that
data points may have been assigned to the wrong cluster.</p>
<p>Six clusters are best suitable for our analysis</p>
</div>
<div id="visualisation-of-silhouette-score" class="section level2">
<h2>Visualisation of Silhouette score</h2>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="co"># Function to calculate silhouette coefficients</span></span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a>calculate_silhouette <span class="ot">&lt;-</span> <span class="cf">function</span>(data, clusters) {</span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a>  sil <span class="ot">&lt;-</span> <span class="fu">silhouette</span>(clusters, <span class="fu">dist</span>(data))</span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a>  <span class="fu">return</span>(sil)</span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a>}</span>
<span id="cb60-6"><a href="#cb60-6" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" tabindex="-1"></a><span class="co"># Perform PCA</span></span>
<span id="cb60-8"><a href="#cb60-8" tabindex="-1"></a>pc <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(data_final_scaled, <span class="at">center =</span> <span class="cn">FALSE</span>, <span class="at">scale =</span> <span class="cn">FALSE</span>)</span>
<span id="cb60-9"><a href="#cb60-9" tabindex="-1"></a>pc_data <span class="ot">&lt;-</span> pc<span class="sc">$</span>x[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]  <span class="co"># Use first 4 principal components</span></span>
<span id="cb60-10"><a href="#cb60-10" tabindex="-1"></a></span>
<span id="cb60-11"><a href="#cb60-11" tabindex="-1"></a><span class="co"># Perform K-means clustering with K = 6</span></span>
<span id="cb60-12"><a href="#cb60-12" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># Set seed for reproducibility</span></span>
<span id="cb60-13"><a href="#cb60-13" tabindex="-1"></a>kmeans_result <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(pc_data, <span class="at">centers =</span> <span class="dv">6</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb60-14"><a href="#cb60-14" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> kmeans_result<span class="sc">$</span>cluster</span>
<span id="cb60-15"><a href="#cb60-15" tabindex="-1"></a></span>
<span id="cb60-16"><a href="#cb60-16" tabindex="-1"></a><span class="co"># Calculate silhouette coefficients</span></span>
<span id="cb60-17"><a href="#cb60-17" tabindex="-1"></a>silhouette_scores <span class="ot">&lt;-</span> <span class="fu">calculate_silhouette</span>(pc_data, clusters)</span>
<span id="cb60-18"><a href="#cb60-18" tabindex="-1"></a></span>
<span id="cb60-19"><a href="#cb60-19" tabindex="-1"></a><span class="co"># Plot silhouette scores</span></span>
<span id="cb60-20"><a href="#cb60-20" tabindex="-1"></a><span class="fu">fviz_silhouette</span>(silhouette_scores, <span class="at">main =</span> <span class="st">&quot;Silhouette Plot for K-means Clustering&quot;</span>)</span></code></pre></div>
<pre><code>##   cluster size ave.sil.width
## 1       1  331          0.33
## 2       2   22          0.65
## 3       3   95          0.40
## 4       4  111          0.45
## 5       5  300          0.42
## 6       6  141          0.34</code></pre>
<p><img src="pca-kmeans-clustering_files/figure-html/unnamed-chunk-27-1.png" width="672" />
# Cluster Profiles</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="co"># Assign cluster labels to original scaled dataset</span></span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a>data_final_scaled <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data_final_scaled, <span class="at">Cluster =</span> kmeans_result<span class="sc">$</span>cluster)</span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a><span class="co"># Calculate mean of original variables by cluster</span></span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a>cluster_means_scaled <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(. <span class="sc">~</span> Cluster, <span class="at">data =</span> data_final_scaled[, <span class="sc">-</span><span class="dv">1</span>], <span class="at">FUN =</span> mean)</span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a><span class="co"># Visualize cluster profiles (e.g., using bar plots)</span></span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb62-10"><a href="#cb62-10" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" tabindex="-1"></a><span class="co"># Reshape data for plotting</span></span>
<span id="cb62-12"><a href="#cb62-12" tabindex="-1"></a>cluster_means_long_scaled <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(cluster_means_scaled, <span class="at">cols =</span> <span class="sc">-</span>Cluster, <span class="at">names_to =</span> <span class="st">&quot;Variable&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Mean&quot;</span>)</span>
<span id="cb62-13"><a href="#cb62-13" tabindex="-1"></a></span>
<span id="cb62-14"><a href="#cb62-14" tabindex="-1"></a><span class="co"># Create bar plot</span></span>
<span id="cb62-15"><a href="#cb62-15" tabindex="-1"></a><span class="fu">ggplot</span>(cluster_means_long_scaled, <span class="fu">aes</span>(<span class="at">x =</span> Variable, <span class="at">y =</span> Mean, <span class="at">fill =</span> <span class="fu">factor</span>(Cluster))) <span class="sc">+</span></span>
<span id="cb62-16"><a href="#cb62-16" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb62-17"><a href="#cb62-17" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Cluster Profiles (Scaled Data)&quot;</span>,</span>
<span id="cb62-18"><a href="#cb62-18" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Variable&quot;</span>,</span>
<span id="cb62-19"><a href="#cb62-19" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mean&quot;</span>,</span>
<span id="cb62-20"><a href="#cb62-20" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;Cluster&quot;</span>) <span class="sc">+</span></span>
<span id="cb62-21"><a href="#cb62-21" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="pca-kmeans-clustering_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
</div>
<div id="plotly-histograms-of-cluster-profiles" class="section level2">
<h2>Plotly Histograms of cluster profiles</h2>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="co"># Create interactive plotly bar plot</span></span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a><span class="fu">plot_ly</span>(cluster_means_long_scaled, <span class="at">x =</span> <span class="sc">~</span>Variable, <span class="at">y =</span> <span class="sc">~</span>Mean, <span class="at">color =</span> <span class="sc">~</span><span class="fu">factor</span>(Cluster), <span class="at">type =</span> <span class="st">&quot;bar&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">&quot;Cluster Profiles (Scaled Data)&quot;</span>,</span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;Variable&quot;</span>),</span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;Mean&quot;</span>),</span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a>         <span class="at">barmode =</span> <span class="st">&quot;group&quot;</span>)</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-ce28ae593bde0f735d05" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-ce28ae593bde0f735d05">{"x":{"visdat":{"cb20314f27dd":["function () ","plotlyVisDat"]},"cur_data":"cb20314f27dd","attrs":{"cb20314f27dd":{"x":{},"y":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Cluster Profiles (Scaled Data)","xaxis":{"domain":[0,1],"automargin":true,"title":"Variable","type":"category","categoryorder":"array","categoryarray":["Age","AnnualIncomex1000","Annualspendingonelectronics","Edcoded","FFcoded","Location_mean_encoding","MaritalStatusmarried","MaritalStatussingle","MonthlyElectronicsSpend","MonthlyHouseholdSpend","PLcoded","PurchasingDecisionMakerfamily","PurchasingDecisionMakersingle","PurchasingFrequencyeveryxmonths","Spendingasofincome","TechnologyAdoptionearly","TechnologyAdoptionlate","Total_Monthly_Spend","tv_viewing_scaled","WorkStatusnone","WorkStatusprofessional"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Mean"},"barmode":"group","hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Edcoded","AnnualIncomex1000","Age","PLcoded","MonthlyElectronicsSpend","Annualspendingonelectronics","Spendingasofincome","MonthlyHouseholdSpend","PurchasingFrequencyeveryxmonths","FFcoded","Location_mean_encoding","MaritalStatusmarried","MaritalStatussingle","WorkStatusnone","WorkStatusprofessional","PurchasingDecisionMakerfamily","PurchasingDecisionMakersingle","TechnologyAdoptionearly","TechnologyAdoptionlate","tv_viewing_scaled","Total_Monthly_Spend"],"y":[0.66767371601208458,0.021996003050976015,0.49103401227950494,3.1812688821752264,0.29211890641900712,0.29211890641900712,0.0094790564333300641,0.21004134202575928,0.40611943176705018,3.3413897280966767,33.498177728287672,0.6737160120845922,0.32628398791540786,0.28700906344410876,0.71299093655589119,0.50453172205438068,0.49546827794561932,1,0,-0.37316765037572092,0.22593305980289977],"type":"bar","name":"1","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Edcoded","AnnualIncomex1000","Age","PLcoded","MonthlyElectronicsSpend","Annualspendingonelectronics","Spendingasofincome","MonthlyHouseholdSpend","PurchasingFrequencyeveryxmonths","FFcoded","Location_mean_encoding","MaritalStatusmarried","MaritalStatussingle","WorkStatusnone","WorkStatusprofessional","PurchasingDecisionMakerfamily","PurchasingDecisionMakersingle","TechnologyAdoptionearly","TechnologyAdoptionlate","tv_viewing_scaled","Total_Monthly_Spend"],"y":[1.4545454545454546,0.02609308885754584,0.32478005865102638,3.0454545454545454,0.43658810325476988,0.43658810325476988,0.01275852633782661,0.33516746411483256,0.37524177949709864,3.9545454545454546,42.363636363636367,0.13636363636363635,0.86363636363636365,0.045454545454545456,0.95454545454545459,0.045454545454545456,0.95454545454545459,0.90909090909090906,0.090909090909090912,-0.033424153927011056,0.35529972211194916],"type":"bar","name":"2","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Edcoded","AnnualIncomex1000","Age","PLcoded","MonthlyElectronicsSpend","Annualspendingonelectronics","Spendingasofincome","MonthlyHouseholdSpend","PurchasingFrequencyeveryxmonths","FFcoded","Location_mean_encoding","MaritalStatusmarried","MaritalStatussingle","WorkStatusnone","WorkStatusprofessional","PurchasingDecisionMakerfamily","PurchasingDecisionMakersingle","TechnologyAdoptionearly","TechnologyAdoptionlate","tv_viewing_scaled","Total_Monthly_Spend"],"y":[1.5894736842105264,0.038319352683542425,0.53056027164685904,1.0842105263157895,0.43833658219623128,0.43833658219623128,0.010629696105021296,0.30822714681440444,0.54669652855543116,1.0842105263157895,28.995463702609609,0.94736842105263153,0.052631578947368418,0.52631578947368418,0.47368421052631576,0.94736842105263153,0.052631578947368418,0.084210526315789472,0.91578947368421049,1.1388051500552239,0.33325672259250749],"type":"bar","name":"3","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Edcoded","AnnualIncomex1000","Age","PLcoded","MonthlyElectronicsSpend","Annualspendingonelectronics","Spendingasofincome","MonthlyHouseholdSpend","PurchasingFrequencyeveryxmonths","FFcoded","Location_mean_encoding","MaritalStatusmarried","MaritalStatussingle","WorkStatusnone","WorkStatusprofessional","PurchasingDecisionMakerfamily","PurchasingDecisionMakersingle","TechnologyAdoptionearly","TechnologyAdoptionlate","tv_viewing_scaled","Total_Monthly_Spend"],"y":[1.5045045045045045,0.03875525737302888,0.58761987794245862,1.027027027027027,0.43354465576687795,0.43354465576687795,0.010472484751600203,0.31839734471313419,0.62411347517730498,1.027027027027027,33.32525380123225,0.88288288288288286,0.11711711711711711,0.43243243243243246,0.56756756756756754,0.88288288288288286,0.11711711711711711,0.027027027027027029,0.97297297297297303,1.3587564428307846,0.34084739761595656],"type":"bar","name":"4","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Edcoded","AnnualIncomex1000","Age","PLcoded","MonthlyElectronicsSpend","Annualspendingonelectronics","Spendingasofincome","MonthlyHouseholdSpend","PurchasingFrequencyeveryxmonths","FFcoded","Location_mean_encoding","MaritalStatusmarried","MaritalStatussingle","WorkStatusnone","WorkStatusprofessional","PurchasingDecisionMakerfamily","PurchasingDecisionMakersingle","TechnologyAdoptionearly","TechnologyAdoptionlate","tv_viewing_scaled","Total_Monthly_Spend"],"y":[0.59666666666666668,0.018928067700987306,0.46741935483870967,3.27,0.23559670781893002,0.23559670781893002,0.0086678909373452857,0.18898245614035086,0.43808510638297871,3.2400000000000002,29.716081895388793,0.71333333333333337,0.28666666666666668,0.34666666666666668,0.65333333333333332,0.45333333333333331,0.54666666666666663,1,0,-0.33559516544160889,0.19846433770014557],"type":"bar","name":"5","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Edcoded","AnnualIncomex1000","Age","PLcoded","MonthlyElectronicsSpend","Annualspendingonelectronics","Spendingasofincome","MonthlyHouseholdSpend","PurchasingFrequencyeveryxmonths","FFcoded","Location_mean_encoding","MaritalStatusmarried","MaritalStatussingle","WorkStatusnone","WorkStatusprofessional","PurchasingDecisionMakerfamily","PurchasingDecisionMakersingle","TechnologyAdoptionearly","TechnologyAdoptionlate","tv_viewing_scaled","Total_Monthly_Spend"],"y":[0.62411347517730498,0.027818623773369744,0.45309997712194006,3.4822695035460991,0.20628666491550651,0.20628666491550651,0.0087018080609309791,0.16646136618141097,0.5139580503998793,3.3900709219858154,25.344726096705315,0.65248226950354615,0.3475177304964539,0.36879432624113473,0.63120567375886527,0.48226950354609927,0.51773049645390068,0.97872340425531912,0.021276595744680851,-0.24167433415760914,0.17459506333426245],"type":"bar","name":"6","marker":{"color":"rgba(255,217,47,1)","line":{"color":"rgba(255,217,47,1)"}},"textfont":{"color":"rgba(255,217,47,1)"},"error_y":{"color":"rgba(255,217,47,1)"},"error_x":{"color":"rgba(255,217,47,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="segmentation-analysis-of-six-clusters" class="section level2">
<h2>Segmentation Analysis of Six Clusters</h2>
<p>In our analysis, we identified six distinct clusters based on various
demographic and spending patterns related to electronics
consumption.</p>
<p><em>Cluster 1 (Frugal Explorers)</em>, representing individuals in
the middle-age group, exhibits the lowest mean monthly electronics
spending. They seem inclined to explore purchases at different
locations, possibly seeking the best prices. Moreover, they show
particular interest in favorite features of TV programming. This cluster
also demonstrates the lowest annual spending on electronics, lower
employment scores, and a tendency towards lower education levels.
Additionally, they are predominantly married and categorized as early
technology adopters.</p>
<p><em>Cluster 2 (Transitioning Consumers)</em> consists of individuals
nearing retirement age, showing the third-highest mean monthly
electronic spend. They exhibit moderate tendencies to explore purchases
at different locations and show less interest in favorite TV programming
features. With the fourth-lowest employment scores and average education
levels, they are mostly married and characterized as late technology
adopters.</p>
<p><em>Cluster 3 (Tech-Savvy Middle Agers)</em> comprises adults, likely
in their early forties, with the second-highest mean monthly electronics
spending. They exhibit moderate tendencies to explore purchases at
various locations and show a particular interest in favorite TV
programming features. With the fifth-lowest employment scores, they are
categorised as late technology adopters.</p>
<p><em>Cluster 4 (Pragmatic Spenders) </em> represents individuals just
before reaching middle age, displaying the fourth-highest mean monthly
electronic spend. They exhibit moderate tendencies to explore purchases
at different locations and show little interest in favorite TV
programming features. With the third-lowest employment scores, they are
categorised as late technology adopters.</p>
<p><em>Cluster 5 (Elite Enthusiasts)</em>, identified as “Super
customers,” consists of the youngest individuals, likely in their late
twenties, exhibiting the highest mean monthly electronics spending. They
prefer exploring purchases at various locations and show a strong
affinity for gadgets and TV programming. With the sixth-lowest
employment scores, they are predominantly working professionals and
early technology adopters.</p>
<p><em>Cluster 6(Frugal Trendsetters)</em> comprises adults in their
mid-thirties, displaying the second-lowest mean monthly electronics
spending. They prefer exploring purchases at various locations and
exhibit a particular interest in favorite TV programming features. With
the third-lowest employment scores, they are characterised as early
adopters of technology.</p>
</div>
</div>
<div id="counclusion" class="section level1">
<h1>Counclusion</h1>
<p>This segmentation analysis provides valuable insights for electronics
businesses to tailor their marketing strategies. By understanding the
distinct preferences and behaviors of each cluster, businesses can
optimise product offerings, target marketing campaigns effectively, and
enhance customer experiences to drive sales and foster brand
loyalty.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
